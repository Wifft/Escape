(()=>{"use strict";var t={648:(t,e,s)=>{function i(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}s.r(e),s.d(e,{Euler:()=>Lt,Matrix3:()=>ct,Matrix4:()=>gt,Pose:()=>Rt,Quaternion:()=>Ft,SphericalCoordinates:()=>_t,Vector2:()=>Z,Vector3:()=>J,Vector4:()=>et,_Euler:()=>Lt,_MathUtils:()=>kt,_Pose:()=>Rt,_SphericalCoordinates:()=>_t,acos:()=>M,asin:()=>E,assert:()=>i,atan:()=>S,checkNumber:()=>k,clamp:()=>v,clone:()=>u,config:()=>h,configure:()=>o,cos:()=>m,degrees:()=>w,equals:()=>x,exactEquals:()=>b,formatValue:()=>a,isArray:()=>c,lerp:()=>O,radians:()=>p,sin:()=>g,tan:()=>y,toDegrees:()=>f,toRadians:()=>d,withEpsilon:()=>P});const r=1/Math.PI*180,n=1/180*Math.PI,h={};function o(t={}){for(const e in t)i(e in h),h[e]=t[e];return h}function a(t,{precision:e=h.precision||4}={}){return t=function(t){return Math.round(t/h.EPSILON)*h.EPSILON}(t),"".concat(parseFloat(t.toPrecision(e)))}function c(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function u(t){return t.clone?t.clone():new Array(...t)}function l(t,e,s){if(c(t)){s=s||((i=t).clone?i.clone():new Array(i.length));for(let i=0;i<s.length&&i<t.length;++i)s[i]=e(t[i],i,s);return s}var i;return e(t)}function d(t){return p(t)}function f(t){return w(t)}function p(t,e){return l(t,(t=>t*n),e)}function w(t,e){return l(t,(t=>t*r),e)}function g(t){return l(t,(t=>Math.sin(t)))}function m(t){return l(t,(t=>Math.cos(t)))}function y(t){return l(t,(t=>Math.tan(t)))}function E(t){return l(t,(t=>Math.asin(t)))}function M(t){return l(t,(t=>Math.acos(t)))}function S(t){return l(t,(t=>Math.atan(t)))}function v(t,e,s){return l(t,(t=>Math.max(e,Math.min(s,t))))}function O(t,e,s){return c(t)?t.map(((t,i)=>O(t,e[i],s))):s*e+(1-s)*t}function x(t,e,s){const i=h.EPSILON;s&&(h.EPSILON=s);try{if(t===e)return!0;if(c(t)&&c(e)){if(t.length!==e.length)return!1;for(let s=0;s<t.length;++s)if(!x(t[s],e[s]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):!(!Number.isFinite(t)||!Number.isFinite(e))&&Math.abs(t-e)<=h.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}finally{h.EPSILON=i}}function b(t,e){if(t===e)return!0;if(t&&"object"==typeof t&&e&&"object"==typeof e){if(t.constructor!==e.constructor)return!1;if(t.exactEquals)return t.exactEquals(e)}if(c(t)&&c(e)){if(t.length!==e.length)return!1;for(let s=0;s<t.length;++s)if(!b(t[s],e[s]))return!1;return!0}return!1}function P(t,e){const s=h.EPSILON;let i;h.EPSILON=t;try{i=e()}finally{h.EPSILON=s}return i}h.EPSILON=1e-12,h.debug=!1,h.precision=4,h.printTypes=!1,h.printDegrees=!1,h.printRowMajor=!0;class F extends(function(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}(Array)){get ELEMENTS(){return i(!1),0}clone(){return(new this.constructor).copy(this)}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}fromArray(t,e=0){for(let s=0;s<this.ELEMENTS;++s)this[s]=t[s+e];return this.check()}to(t){return t===this?this:c(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toArray(t=[],e=0){for(let s=0;s<this.ELEMENTS;++s)t[e+s]=this[s];return t}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(h)}formatString(t){let e="";for(let s=0;s<this.ELEMENTS;++s)e+=(s>0?", ":"")+a(this[s],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(e,"]")}equals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(!x(this[e],t[e]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,e,s){void 0===s&&(s=e,e=t,t=this);for(let i=0;i<this.ELEMENTS;++i){const r=t[i];this[i]=r+s*(e[i]-r)}return this.check()}min(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}max(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}clamp(t,e){for(let s=0;s<this.ELEMENTS;++s)this[s]=Math.min(Math.max(this[s],t[s]),e[s]);return this.check()}add(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]+=e[t];return this.check()}subtract(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]-=e[t];return this.check()}scale(t){if(Array.isArray(t))return this.multiply(t);for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}sub(t){return this.subtract(t)}setScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}addScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}divideScalar(t){return this.scale(1/t)}clampScalar(t,e){for(let s=0;s<this.ELEMENTS;++s)this[s]=Math.min(Math.max(this[s],t),e);return this.check()}multiplyByScalar(t){return this.scale(t)}get elements(){return this}check(){if(h.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let t=this.length===this.ELEMENTS;for(let e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}}function k(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function V(t,e,s=""){if(h.debug&&!function(t,e){if(t.length!==e)return!1;for(let e=0;e<t.length;++e)if(!Number.isFinite(t[e]))return!1;return!0}(t,e))throw new Error("math.gl: ".concat(s," some fields set to invalid numbers'"));return t}const _={};function T(t,e){_[t]||(_[t]=!0,console.warn("".concat(t," has been removed in version ").concat(e,", see upgrade guide for more information")))}class A extends F{get ELEMENTS(){return i(!1),0}copy(t){return i(!1),this}get x(){return this[0]}set x(t){this[0]=k(t)}get y(){return this[1]}set y(t){this[1]=k(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let e=0;for(let s=0;s<this.ELEMENTS;++s){const i=this[s]-t[s];e+=i*i}return k(e)}dot(t){let e=0;for(let s=0;s<this.ELEMENTS;++s)e+=this[s]*t[s];return k(e)}normalize(){const t=this.magnitude();if(0!==t)for(let e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}multiply(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]*=e[t];return this.check()}divide(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e[t];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return i(t>=0&&t<this.ELEMENTS,"index is out of range"),k(this[t])}setComponent(t,e){return i(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}addVectors(t,e){return this.copy(t).add(e)}subVectors(t,e){return this.copy(t).subtract(e)}multiplyVectors(t,e){return this.copy(t).multiply(e)}addScaledVector(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}}var L,R=1e-6,N="undefined"!=typeof Float32Array?Float32Array:Array;function I(t,e,s){var i=e[0],r=e[1];return t[0]=s[0]*i+s[3]*r+s[6],t[1]=s[1]*i+s[4]*r+s[7],t}function C(t,e,s){var i=e[0],r=e[1];return t[0]=s[0]*i+s[4]*r+s[12],t[1]=s[1]*i+s[5]*r+s[13],t}function D(t,e,s){const i=e[0],r=e[1],n=s[3]*i+s[7]*r||1;return t[0]=(s[0]*i+s[4]*r)/n,t[1]=(s[1]*i+s[5]*r)/n,t}function j(t,e,s){const i=e[0],r=e[1],n=e[2],h=s[3]*i+s[7]*r+s[11]*n||1;return t[0]=(s[0]*i+s[4]*r+s[8]*n)/h,t[1]=(s[1]*i+s[5]*r+s[9]*n)/h,t[2]=(s[2]*i+s[6]*r+s[10]*n)/h,t}function z(t,e,s){const i=e[0],r=e[1],n=e[2];return t[0]=s[0]*i+s[3]*r+s[6]*n,t[1]=s[1]*i+s[4]*r+s[7]*n,t[2]=s[2]*i+s[5]*r+s[8]*n,t[3]=e[3],t}Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)}),L=new N(2),N!=Float32Array&&(L[0]=0,L[1]=0);class Z extends A{constructor(t=0,e=0){super(2),c(t)&&1===arguments.length?this.copy(t):(h.debug&&(k(t),k(e)),this[0]=t,this[1]=e)}set(t,e){return this[0]=t,this[1]=e,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this.check()}fromObject(t){return h.debug&&(k(t.x),k(t.y)),this[0]=t.x,this[1]=t.y,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t}get ELEMENTS(){return 2}horizontalAngle(){return Math.atan2(this.y,this.x)}verticalAngle(){return Math.atan2(this.x,this.y)}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return C(this,this,t),this.check()}transformAsVector(t){return D(this,this,t),this.check()}transformByMatrix3(t){return I(this,this,t),this.check()}transformByMatrix2x3(t){return function(t,e,s){var i=e[0],r=e[1];t[0]=s[0]*i+s[2]*r+s[4],t[1]=s[1]*i+s[3]*r+s[5]}(this,this,t),this.check()}transformByMatrix2(t){return function(t,e,s){var i=e[0],r=e[1];t[0]=s[0]*i+s[2]*r,t[1]=s[1]*i+s[3]*r}(this,this,t),this.check()}}function Y(){var t=new N(3);return N!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function X(t){var e=t[0],s=t[1],i=t[2];return Math.hypot(e,s,i)}function q(t,e,s){var i=new N(3);return i[0]=t,i[1]=e,i[2]=s,i}function K(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function W(t,e,s){var i=e[0],r=e[1],n=e[2],h=s[0],o=s[1],a=s[2];return t[0]=r*a-n*o,t[1]=n*h-i*a,t[2]=i*o-r*h,t}function B(t,e,s){var i=e[0],r=e[1],n=e[2],h=s[3]*i+s[7]*r+s[11]*n+s[15];return h=h||1,t[0]=(s[0]*i+s[4]*r+s[8]*n+s[12])/h,t[1]=(s[1]*i+s[5]*r+s[9]*n+s[13])/h,t[2]=(s[2]*i+s[6]*r+s[10]*n+s[14])/h,t}function Q(t,e,s){var i=e[0],r=e[1],n=e[2];return t[0]=i*s[0]+r*s[3]+n*s[6],t[1]=i*s[1]+r*s[4]+n*s[7],t[2]=i*s[2]+r*s[5]+n*s[8],t}function G(t,e,s){var i=s[0],r=s[1],n=s[2],h=s[3],o=e[0],a=e[1],c=e[2],u=r*c-n*a,l=n*o-i*c,d=i*a-r*o,f=r*d-n*l,p=n*u-i*d,w=i*l-r*u,g=2*h;return u*=g,l*=g,d*=g,f*=2,p*=2,w*=2,t[0]=o+u+f,t[1]=a+l+p,t[2]=c+d+w,t}var H=X;Y();const $=[0,0,0],U={};class J extends A{static get ZERO(){return U.ZERO=U.ZERO||Object.freeze(new J(0,0,0,0))}constructor(t=0,e=0,s=0){super(-0,-0,-0),1===arguments.length&&c(t)?this.copy(t):(h.debug&&(k(t),k(e),k(s)),this[0]=t,this[1]=e,this[2]=s)}set(t,e,s){return this[0]=t,this[1]=e,this[2]=s,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return h.debug&&(k(t.x),k(t.y),k(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=k(t)}angle(t){return s=t,i=(e=this)[0],r=e[1],n=e[2],h=s[0],o=s[1],a=s[2],u=(c=Math.sqrt(i*i+r*r+n*n)*Math.sqrt(h*h+o*o+a*a))&&K(e,s)/c,Math.acos(Math.min(Math.max(u,-1),1));var e,s,i,r,n,h,o,a,c,u}cross(t){return W(this,this,t),this.check()}rotateX({radians:t,origin:e=$}){return function(t,e,s,i){var r=[],n=[];r[0]=e[0]-s[0],r[1]=e[1]-s[1],r[2]=e[2]-s[2],n[0]=r[0],n[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),n[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),t[0]=n[0]+s[0],t[1]=n[1]+s[1],t[2]=n[2]+s[2]}(this,this,e,t),this.check()}rotateY({radians:t,origin:e=$}){return function(t,e,s,i){var r=[],n=[];r[0]=e[0]-s[0],r[1]=e[1]-s[1],r[2]=e[2]-s[2],n[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),n[1]=r[1],n[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),t[0]=n[0]+s[0],t[1]=n[1]+s[1],t[2]=n[2]+s[2]}(this,this,e,t),this.check()}rotateZ({radians:t,origin:e=$}){return function(t,e,s,i){var r=[],n=[];r[0]=e[0]-s[0],r[1]=e[1]-s[1],r[2]=e[2]-s[2],n[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),n[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),n[2]=r[2],t[0]=n[0]+s[0],t[1]=n[1]+s[1],t[2]=n[2]+s[2]}(this,this,e,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return B(this,this,t),this.check()}transformAsVector(t){return j(this,this,t),this.check()}transformByMatrix3(t){return Q(this,this,t),this.check()}transformByMatrix2(t){return function(t,e,s){const i=e[0],r=e[1];t[0]=s[0]*i+s[2]*r,t[1]=s[1]*i+s[3]*r,t[2]=e[2]}(this,this,t),this.check()}transformByQuaternion(t){return G(this,this,t),this.check()}}const tt={};class et extends A{static get ZERO(){return tt.ZERO=tt.ZERO||Object.freeze(new et(0,0,0,0))}constructor(t=0,e=0,s=0,i=0){super(-0,-0,-0,-0),c(t)&&1===arguments.length?this.copy(t):(h.debug&&(k(t),k(e),k(s),k(i)),this[0]=t,this[1]=e,this[2]=s,this[3]=i)}set(t,e,s,i){return this[0]=t,this[1]=e,this[2]=s,this[3]=i,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}fromObject(t){return h.debug&&(k(t.x),k(t.y),k(t.z),k(t.w)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t.w=this[3],t}get ELEMENTS(){return 4}get z(){return this[2]}set z(t){this[2]=k(t)}get w(){return this[3]}set w(t){this[3]=k(t)}transform(t){return B(this,this,t),this.check()}transformByMatrix3(t){return z(this,this,t),this.check()}transformByMatrix2(t){return function(t,e,s){const i=e[0],r=e[1];t[0]=s[0]*i+s[2]*r,t[1]=s[1]*i+s[3]*r,t[2]=e[2],t[3]=e[3]}(this,this,t),this.check()}transformByQuaternion(t){return G(this,this,t),this.check()}applyMatrix4(t){return t.transform(this,this),this}}class st extends F{get ELEMENTS(){return i(!1),0}get RANK(){return i(!1),0}toString(){let t="[";if(h.printRowMajor){t+="row-major:";for(let e=0;e<this.RANK;++e)for(let s=0;s<this.RANK;++s)t+=" ".concat(this[s*this.RANK+e])}else{t+="column-major:";for(let e=0;e<this.ELEMENTS;++e)t+=" ".concat(this[e])}return t+="]",t}getElementIndex(t,e){return e*this.RANK+t}getElement(t,e){return this[e*this.RANK+t]}setElement(t,e,s){return this[e*this.RANK+t]=k(s),this}getColumn(t,e=new Array(this.RANK).fill(-0)){const s=t*this.RANK;for(let t=0;t<this.RANK;++t)e[t]=this[s+t];return e}setColumn(t,e){const s=t*this.RANK;for(let t=0;t<this.RANK;++t)this[s+t]=e[t];return this}}function it(t,e,s){var i=e[0],r=e[1],n=e[2],h=e[3],o=e[4],a=e[5],c=e[6],u=e[7],l=e[8],d=s[0],f=s[1],p=s[2],w=s[3],g=s[4],m=s[5],y=s[6],E=s[7],M=s[8];return t[0]=d*i+f*h+p*c,t[1]=d*r+f*o+p*u,t[2]=d*n+f*a+p*l,t[3]=w*i+g*h+m*c,t[4]=w*r+g*o+m*u,t[5]=w*n+g*a+m*l,t[6]=y*i+E*h+M*c,t[7]=y*r+E*o+M*u,t[8]=y*n+E*a+M*l,t}function rt(t,e,s){var i=s[0],r=s[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}const nt=Object.freeze([1,0,0,0,1,0,0,0,1]),ht=Object.freeze([0,0,0,0,0,0,0,0,0]),ot=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL1ROW0:3,COL1ROW1:4,COL1ROW2:5,COL2ROW0:6,COL2ROW1:7,COL2ROW2:8}),at={};class ct extends st{static get IDENTITY(){return at.IDENTITY=at.IDENTITY||Object.freeze(new ct(nt)),at.IDENTITY}static get ZERO(){return at.ZERO=at.ZERO||Object.freeze(new ct(ht)),at.ZERO}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return ot}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}set(t,e,s,i,r,n,h,o,a){return this[0]=t,this[1]=e,this[2]=s,this[3]=i,this[4]=r,this[5]=n,this[6]=h,this[7]=o,this[8]=a,this.check()}setRowMajor(t,e,s,i,r,n,h,o,a){return this[0]=t,this[1]=i,this[2]=h,this[3]=e,this[4]=r,this[5]=o,this[6]=s,this[7]=n,this[8]=a,this.check()}determinant(){return e=(t=this)[0],s=t[1],i=t[2],r=t[3],n=t[4],h=t[5],o=t[6],a=t[7],e*((c=t[8])*n-h*a)+s*(-c*r+h*o)+i*(a*r-n*o);var t,e,s,i,r,n,h,o,a,c}identity(){return this.copy(nt)}fromQuaternion(t){return function(t,e){var s=e[0],i=e[1],r=e[2],n=e[3],h=s+s,o=i+i,a=r+r,c=s*h,u=i*h,l=i*o,d=r*h,f=r*o,p=r*a,w=n*h,g=n*o,m=n*a;t[0]=1-l-p,t[3]=u-m,t[6]=d+g,t[1]=u+m,t[4]=1-c-p,t[7]=f-w,t[2]=d-g,t[5]=f+w,t[8]=1-c-l}(this,t),this.check()}transpose(){return function(t,e){if(t===e){var s=e[1],i=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=s,t[5]=e[7],t[6]=i,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8]}(this,this),this.check()}invert(){return function(t,e){var s=e[0],i=e[1],r=e[2],n=e[3],h=e[4],o=e[5],a=e[6],c=e[7],u=e[8],l=u*h-o*c,d=-u*n+o*a,f=c*n-h*a,p=s*l+i*d+r*f;p&&(p=1/p,t[0]=l*p,t[1]=(-u*i+r*c)*p,t[2]=(o*i-r*h)*p,t[3]=d*p,t[4]=(u*s-r*a)*p,t[5]=(-o*s+r*n)*p,t[6]=f*p,t[7]=(-c*s+i*a)*p,t[8]=(h*s-i*n)*p)}(this,this),this.check()}multiplyLeft(t){return it(this,t,this),this.check()}multiplyRight(t){return it(this,this,t),this.check()}rotate(t){return function(t,e,s){var i=e[0],r=e[1],n=e[2],h=e[3],o=e[4],a=e[5],c=e[6],u=e[7],l=e[8],d=Math.sin(s),f=Math.cos(s);t[0]=f*i+d*h,t[1]=f*r+d*o,t[2]=f*n+d*a,t[3]=f*h-d*i,t[4]=f*o-d*r,t[5]=f*a-d*n,t[6]=c,t[7]=u,t[8]=l}(this,this,t),this.check()}scale(t){return Array.isArray(t)?rt(this,this,t):rt(this,this,[t,t,t]),this.check()}translate(t){return function(t,e,s){var i=e[0],r=e[1],n=e[2],h=e[3],o=e[4],a=e[5],c=e[6],u=e[7],l=e[8],d=s[0],f=s[1];t[0]=i,t[1]=r,t[2]=n,t[3]=h,t[4]=o,t[5]=a,t[6]=d*i+f*h+c,t[7]=d*r+f*o+u,t[8]=d*n+f*a+l}(this,this,t),this.check()}transform(t,e){switch(t.length){case 2:e=I(e||[-0,-0],t,this);break;case 3:e=Q(e||[-0,-0,-0],t,this);break;case 4:e=z(e||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return V(e,t.length),e}transformVector(t,e){return T("Matrix3.transformVector"),this.transform(t,e)}transformVector2(t,e){return T("Matrix3.transformVector"),this.transform(t,e)}transformVector3(t,e){return T("Matrix3.transformVector"),this.transform(t,e)}}function ut(t,e,s){var i=e[0],r=e[1],n=e[2],h=e[3],o=e[4],a=e[5],c=e[6],u=e[7],l=e[8],d=e[9],f=e[10],p=e[11],w=e[12],g=e[13],m=e[14],y=e[15],E=s[0],M=s[1],S=s[2],v=s[3];return t[0]=E*i+M*o+S*l+v*w,t[1]=E*r+M*a+S*d+v*g,t[2]=E*n+M*c+S*f+v*m,t[3]=E*h+M*u+S*p+v*y,E=s[4],M=s[5],S=s[6],v=s[7],t[4]=E*i+M*o+S*l+v*w,t[5]=E*r+M*a+S*d+v*g,t[6]=E*n+M*c+S*f+v*m,t[7]=E*h+M*u+S*p+v*y,E=s[8],M=s[9],S=s[10],v=s[11],t[8]=E*i+M*o+S*l+v*w,t[9]=E*r+M*a+S*d+v*g,t[10]=E*n+M*c+S*f+v*m,t[11]=E*h+M*u+S*p+v*y,E=s[12],M=s[13],S=s[14],v=s[15],t[12]=E*i+M*o+S*l+v*w,t[13]=E*r+M*a+S*d+v*g,t[14]=E*n+M*c+S*f+v*m,t[15]=E*h+M*u+S*p+v*y,t}function lt(t,e,s){var i=s[0],r=s[1],n=s[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}!function(){var t=new N(4);N!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0)}();const dt=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),ft=Object.freeze([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),pt=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL0ROW3:3,COL1ROW0:4,COL1ROW1:5,COL1ROW2:6,COL1ROW3:7,COL2ROW0:8,COL2ROW1:9,COL2ROW2:10,COL2ROW3:11,COL3ROW0:12,COL3ROW1:13,COL3ROW2:14,COL3ROW3:15}),wt={};class gt extends st{static get IDENTITY(){return wt.IDENTITY=wt.IDENTITY||Object.freeze(new gt(dt)),wt.IDENTITY}static get ZERO(){return wt.ZERO=wt.ZERO||Object.freeze(new gt(ft)),wt.ZERO}get INDICES(){return pt}get ELEMENTS(){return 16}get RANK(){return 4}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,e,s,i,r,n,h,o,a,c,u,l,d,f,p,w){return this[0]=t,this[1]=e,this[2]=s,this[3]=i,this[4]=r,this[5]=n,this[6]=h,this[7]=o,this[8]=a,this[9]=c,this[10]=u,this[11]=l,this[12]=d,this[13]=f,this[14]=p,this[15]=w,this.check()}setRowMajor(t,e,s,i,r,n,h,o,a,c,u,l,d,f,p,w){return this[0]=t,this[1]=r,this[2]=a,this[3]=d,this[4]=e,this[5]=n,this[6]=c,this[7]=f,this[8]=s,this[9]=h,this[10]=u,this[11]=p,this[12]=i,this[13]=o,this[14]=l,this[15]=w,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(dt)}fromQuaternion(t){return function(t,e){var s=e[0],i=e[1],r=e[2],n=e[3],h=s+s,o=i+i,a=r+r,c=s*h,u=i*h,l=i*o,d=r*h,f=r*o,p=r*a,w=n*h,g=n*o,m=n*a;t[0]=1-l-p,t[1]=u+m,t[2]=d-g,t[3]=0,t[4]=u-m,t[5]=1-c-p,t[6]=f+w,t[7]=0,t[8]=d+g,t[9]=f-w,t[10]=1-c-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(this,t),this.check()}frustum({left:t,right:e,bottom:s,top:i,near:r,far:n}){return n===1/0?gt._computeInfinitePerspectiveOffCenter(this,t,e,s,i,r):function(t,e,s,i,r,n,h){var o=1/(s-e),a=1/(r-i),c=1/(n-h);t[0]=2*n*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*n*a,t[6]=0,t[7]=0,t[8]=(s+e)*o,t[9]=(r+i)*a,t[10]=(h+n)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=h*n*2*c,t[15]=0}(this,t,e,s,i,r,n),this.check()}static _computeInfinitePerspectiveOffCenter(t,e,s,i,r,n){const h=2*n/(s-e),o=2*n/(r-i),a=(s+e)/(s-e),c=(r+i)/(r-i),u=-2*n;return t[0]=h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=a,t[9]=c,t[10]=-1,t[11]=-1,t[12]=0,t[13]=0,t[14]=u,t[15]=0,t}lookAt(t,e,s){return 1===arguments.length&&({eye:t,center:e,up:s}=t),function(t,e,s,i){var r,n,h,o,a,c,u,l,d,f,p=e[0],w=e[1],g=e[2],m=i[0],y=i[1],E=i[2],M=s[0],S=s[1],v=s[2];Math.abs(p-M)<R&&Math.abs(w-S)<R&&Math.abs(g-v)<R?function(t){t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(t):(u=p-M,l=w-S,d=g-v,r=y*(d*=f=1/Math.hypot(u,l,d))-E*(l*=f),n=E*(u*=f)-m*d,h=m*l-y*u,(f=Math.hypot(r,n,h))?(r*=f=1/f,n*=f,h*=f):(r=0,n=0,h=0),o=l*h-d*n,a=d*r-u*h,c=u*n-l*r,(f=Math.hypot(o,a,c))?(o*=f=1/f,a*=f,c*=f):(o=0,a=0,c=0),t[0]=r,t[1]=o,t[2]=u,t[3]=0,t[4]=n,t[5]=a,t[6]=l,t[7]=0,t[8]=h,t[9]=c,t[10]=d,t[11]=0,t[12]=-(r*p+n*w+h*g),t[13]=-(o*p+a*w+c*g),t[14]=-(u*p+l*w+d*g),t[15]=1)}(this,t,e=e||[0,0,0],s=s||[0,1,0]),this.check()}ortho({left:t,right:e,bottom:s,top:i,near:r=.1,far:n=500}){return function(t,e,s,i,r,n,h){var o=1/(e-s),a=1/(i-r),c=1/(n-h);t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+s)*o,t[13]=(r+i)*a,t[14]=(h+n)*c,t[15]=1}(this,t,e,s,i,r,n),this.check()}orthographic({fovy:t=45*Math.PI/180,aspect:e=1,focalDistance:s=1,near:i=.1,far:r=500}){if(t>2*Math.PI)throw Error("radians");const n=t/2,h=s*Math.tan(n),o=h*e;return(new gt).ortho({left:-o,right:o,bottom:-h,top:h,near:i,far:r})}perspective({fovy:t,fov:e=45*Math.PI/180,aspect:s=1,near:i=.1,far:r=500}={}){if((t=t||e)>2*Math.PI)throw Error("radians");return function(t,e,s,i,r){var n,h=1/Math.tan(e/2);t[0]=h/s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(n=1/(i-r),t[10]=(r+i)*n,t[14]=2*r*i*n):(t[10]=-1,t[14]=-2*i)}(this,t,s,i,r),this.check()}determinant(){return e=(t=this)[0],s=t[1],i=t[2],r=t[3],n=t[4],h=t[5],o=t[6],a=t[7],c=t[8],u=t[9],l=t[10],d=t[11],f=t[12],p=t[13],w=t[14],(e*h-s*n)*(l*(g=t[15])-d*w)-(e*o-i*n)*(u*g-d*p)+(e*a-r*n)*(u*w-l*p)+(s*o-i*h)*(c*g-d*f)-(s*a-r*h)*(c*w-l*f)+(i*a-r*o)*(c*p-u*f);var t,e,s,i,r,n,h,o,a,c,u,l,d,f,p,w,g}getScale(t=[-0,-0,-0]){return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(t=[-0,-0,-0]){return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t=[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],e=null){const s=this.getScale(e||[-0,-0,-0]),i=1/s[0],r=1/s[1],n=1/s[2];return t[0]=this[0]*i,t[1]=this[1]*r,t[2]=this[2]*n,t[3]=0,t[4]=this[4]*i,t[5]=this[5]*r,t[6]=this[6]*n,t[7]=0,t[8]=this[8]*i,t[9]=this[9]*r,t[10]=this[10]*n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t=[-0,-0,-0,-0,-0,-0,-0,-0,-0],e=null){const s=this.getScale(e||[-0,-0,-0]),i=1/s[0],r=1/s[1],n=1/s[2];return t[0]=this[0]*i,t[1]=this[1]*r,t[2]=this[2]*n,t[3]=this[4]*i,t[4]=this[5]*r,t[5]=this[6]*n,t[6]=this[8]*i,t[7]=this[9]*r,t[8]=this[10]*n,t}transpose(){return function(t,e){if(t===e){var s=e[1],i=e[2],r=e[3],n=e[6],h=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=s,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=n,t[11]=e[14],t[12]=r,t[13]=h,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15]}(this,this),this.check()}invert(){return function(t,e){var s=e[0],i=e[1],r=e[2],n=e[3],h=e[4],o=e[5],a=e[6],c=e[7],u=e[8],l=e[9],d=e[10],f=e[11],p=e[12],w=e[13],g=e[14],m=e[15],y=s*o-i*h,E=s*a-r*h,M=s*c-n*h,S=i*a-r*o,v=i*c-n*o,O=r*c-n*a,x=u*w-l*p,b=u*g-d*p,P=u*m-f*p,F=l*g-d*w,k=l*m-f*w,V=d*m-f*g,_=y*V-E*k+M*F+S*P-v*b+O*x;_&&(_=1/_,t[0]=(o*V-a*k+c*F)*_,t[1]=(r*k-i*V-n*F)*_,t[2]=(w*O-g*v+m*S)*_,t[3]=(d*v-l*O-f*S)*_,t[4]=(a*P-h*V-c*b)*_,t[5]=(s*V-r*P+n*b)*_,t[6]=(g*M-p*O-m*E)*_,t[7]=(u*O-d*M+f*E)*_,t[8]=(h*k-o*P+c*x)*_,t[9]=(i*P-s*k-n*x)*_,t[10]=(p*v-w*M+m*y)*_,t[11]=(l*M-u*v-f*y)*_,t[12]=(o*b-h*F-a*x)*_,t[13]=(s*F-i*b+r*x)*_,t[14]=(w*E-p*S-g*y)*_,t[15]=(u*S-l*E+d*y)*_)}(this,this),this.check()}multiplyLeft(t){return ut(this,t,this),this.check()}multiplyRight(t){return ut(this,this,t),this.check()}rotateX(t){return function(t,e,s){var i=Math.sin(s),r=Math.cos(s),n=e[4],h=e[5],o=e[6],a=e[7],c=e[8],u=e[9],l=e[10],d=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=n*r+c*i,t[5]=h*r+u*i,t[6]=o*r+l*i,t[7]=a*r+d*i,t[8]=c*r-n*i,t[9]=u*r-h*i,t[10]=l*r-o*i,t[11]=d*r-a*i}(this,this,t),this.check()}rotateY(t){return function(t,e,s){var i=Math.sin(s),r=Math.cos(s),n=e[0],h=e[1],o=e[2],a=e[3],c=e[8],u=e[9],l=e[10],d=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=n*r-c*i,t[1]=h*r-u*i,t[2]=o*r-l*i,t[3]=a*r-d*i,t[8]=n*i+c*r,t[9]=h*i+u*r,t[10]=o*i+l*r,t[11]=a*i+d*r}(this,this,t),this.check()}rotateZ(t){return function(t,e,s){var i=Math.sin(s),r=Math.cos(s),n=e[0],h=e[1],o=e[2],a=e[3],c=e[4],u=e[5],l=e[6],d=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=n*r+c*i,t[1]=h*r+u*i,t[2]=o*r+l*i,t[3]=a*r+d*i,t[4]=c*r-n*i,t[5]=u*r-h*i,t[6]=l*r-o*i,t[7]=d*r-a*i}(this,this,t),this.check()}rotateXYZ([t,e,s]){return this.rotateX(t).rotateY(e).rotateZ(s)}rotateAxis(t,e){return function(t,e,s,i){var r,n,h,o,a,c,u,l,d,f,p,w,g,m,y,E,M,S,v,O,x,b,P,F,k=i[0],V=i[1],_=i[2],T=Math.hypot(k,V,_);T<R||(k*=T=1/T,V*=T,_*=T,r=Math.sin(s),h=1-(n=Math.cos(s)),o=e[0],a=e[1],c=e[2],u=e[3],l=e[4],d=e[5],f=e[6],p=e[7],w=e[8],g=e[9],m=e[10],y=e[11],E=k*k*h+n,M=V*k*h+_*r,S=_*k*h-V*r,v=k*V*h-_*r,O=V*V*h+n,x=_*V*h+k*r,b=k*_*h+V*r,P=V*_*h-k*r,F=_*_*h+n,t[0]=o*E+l*M+w*S,t[1]=a*E+d*M+g*S,t[2]=c*E+f*M+m*S,t[3]=u*E+p*M+y*S,t[4]=o*v+l*O+w*x,t[5]=a*v+d*O+g*x,t[6]=c*v+f*O+m*x,t[7]=u*v+p*O+y*x,t[8]=o*b+l*P+w*F,t[9]=a*b+d*P+g*F,t[10]=c*b+f*P+m*F,t[11]=u*b+p*P+y*F,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]))}(this,this,t,e),this.check()}scale(t){return Array.isArray(t)?lt(this,this,t):lt(this,this,[t,t,t]),this.check()}translate(t){return function(t,e,s){var i,r,n,h,o,a,c,u,l,d,f,p,w=s[0],g=s[1],m=s[2];e===t?(t[12]=e[0]*w+e[4]*g+e[8]*m+e[12],t[13]=e[1]*w+e[5]*g+e[9]*m+e[13],t[14]=e[2]*w+e[6]*g+e[10]*m+e[14],t[15]=e[3]*w+e[7]*g+e[11]*m+e[15]):(i=e[0],r=e[1],n=e[2],h=e[3],o=e[4],a=e[5],c=e[6],u=e[7],l=e[8],d=e[9],f=e[10],p=e[11],t[0]=i,t[1]=r,t[2]=n,t[3]=h,t[4]=o,t[5]=a,t[6]=c,t[7]=u,t[8]=l,t[9]=d,t[10]=f,t[11]=p,t[12]=i*w+o*g+l*m+e[12],t[13]=r*w+a*g+d*m+e[13],t[14]=n*w+c*g+f*m+e[14],t[15]=h*w+u*g+p*m+e[15])}(this,this,t),this.check()}transform(t,e){return 4===t.length?(e=function(t,e,s){var i=e[0],r=e[1],n=e[2],h=e[3];return t[0]=s[0]*i+s[4]*r+s[8]*n+s[12]*h,t[1]=s[1]*i+s[5]*r+s[9]*n+s[13]*h,t[2]=s[2]*i+s[6]*r+s[10]*n+s[14]*h,t[3]=s[3]*i+s[7]*r+s[11]*n+s[15]*h,t}(e||[-0,-0,-0,-0],t,this),V(e,4),e):this.transformAsPoint(t,e)}transformAsPoint(t,e){const{length:s}=t;switch(s){case 2:e=C(e||[-0,-0],t,this);break;case 3:e=B(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return V(e,t.length),e}transformAsVector(t,e){switch(t.length){case 2:e=D(e||[-0,-0],t,this);break;case 3:e=j(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return V(e,t.length),e}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,e,s){return this.identity().translate([t,e,s])}transformPoint(t,e){return T("Matrix4.transformPoint","3.0"),this.transformAsPoint(t,e)}transformVector(t,e){return T("Matrix4.transformVector","3.0"),this.transformAsPoint(t,e)}transformDirection(t,e){return T("Matrix4.transformDirection","3.0"),this.transformAsVector(t,e)}}function mt(){var t=new N(4);return N!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function yt(t,e,s){s*=.5;var i=Math.sin(s);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(s),t}function Et(t,e,s){var i=e[0],r=e[1],n=e[2],h=e[3],o=s[0],a=s[1],c=s[2],u=s[3];return t[0]=i*u+h*o+r*c-n*a,t[1]=r*u+h*a+n*o-i*c,t[2]=n*u+h*c+i*a-r*o,t[3]=h*u-i*o-r*a-n*c,t}var Mt,St,vt,Ot=function(t){var e=t[0],s=t[1],i=t[2],r=t[3];return Math.hypot(e,s,i,r)},xt=function(t){var e=t[0],s=t[1],i=t[2],r=t[3];return e*e+s*s+i*i+r*r},bt=(Mt=Y(),St=q(1,0,0),vt=q(0,1,0),function(t,e,s){var i=K(e,s);return i<-.999999?(W(Mt,St,e),H(Mt)<1e-6&&W(Mt,vt,e),function(t,e){var s=e[0],i=e[1],r=e[2],n=s*s+i*i+r*r;n>0&&(n=1/Math.sqrt(n)),t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n}(Mt,Mt),yt(t,Mt,Math.PI),t):i>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(W(Mt,e,s),t[0]=Mt[0],t[1]=Mt[1],t[2]=Mt[2],t[3]=1+i,function(t,e){var s=e[0],i=e[1],r=e[2],n=e[3],h=s*s+i*i+r*r+n*n;return h>0&&(h=1/Math.sqrt(h)),t[0]=s*h,t[1]=i*h,t[2]=r*h,t[3]=n*h,t}(t,t))});mt(),mt(),function(){var t=new N(9);N!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1}();const Pt=[0,0,0,1];class Ft extends F{constructor(t=0,e=0,s=0,i=1){super(-0,-0,-0,-0),Array.isArray(t)&&1===arguments.length?this.copy(t):this.set(t,e,s,i)}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}set(t,e,s,i){return this[0]=t,this[1]=e,this[2]=s,this[3]=i,this.check()}fromMatrix3(t){return function(t,e){var s,i=e[0]+e[4]+e[8];if(i>0)s=Math.sqrt(i+1),t[3]=.5*s,s=.5/s,t[0]=(e[5]-e[7])*s,t[1]=(e[6]-e[2])*s,t[2]=(e[1]-e[3])*s;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var n=(r+1)%3,h=(r+2)%3;s=Math.sqrt(e[3*r+r]-e[3*n+n]-e[3*h+h]+1),t[r]=.5*s,s=.5/s,t[3]=(e[3*n+h]-e[3*h+n])*s,t[n]=(e[3*n+r]+e[3*r+n])*s,t[h]=(e[3*h+r]+e[3*r+h])*s}}(this,t),this.check()}identity(){return function(t){t[0]=0,t[1]=0,t[2]=0,t[3]=1}(this),this.check()}fromAxisRotation(t,e){return yt(this,t,e),this.check()}setAxisAngle(t,e){return this.fromAxisRotation(t,e)}get ELEMENTS(){return 4}get x(){return this[0]}set x(t){this[0]=k(t)}get y(){return this[1]}set y(t){this[1]=k(t)}get z(){return this[2]}set z(t){this[2]=k(t)}get w(){return this[3]}set w(t){this[3]=k(t)}len(){return Ot(this)}lengthSquared(){return xt(this)}dot(t,e){if(void 0!==e)throw new Error("Quaternion.dot only takes one argument");return function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}(this,t)}rotationTo(t,e){return bt(this,t,e),this.check()}add(t,e){if(void 0!==e)throw new Error("Quaternion.add only takes one argument");return function(t,e,s){t[0]=e[0]+s[0],t[1]=e[1]+s[1],t[2]=e[2]+s[2],t[3]=e[3]+s[3]}(this,this,t),this.check()}calculateW(){return function(t,e){var s=e[0],i=e[1],r=e[2];t[0]=s,t[1]=i,t[2]=r,t[3]=Math.sqrt(Math.abs(1-s*s-i*i-r*r))}(this,this),this.check()}conjugate(){return function(t,e){t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3]}(this,this),this.check()}invert(){return function(t,e){var s=e[0],i=e[1],r=e[2],n=e[3],h=s*s+i*i+r*r+n*n,o=h?1/h:0;t[0]=-s*o,t[1]=-i*o,t[2]=-r*o,t[3]=n*o}(this,this),this.check()}lerp(t,e,s){return function(t,e,s,i){var r=e[0],n=e[1],h=e[2],o=e[3];t[0]=r+i*(s[0]-r),t[1]=n+i*(s[1]-n),t[2]=h+i*(s[2]-h),t[3]=o+i*(s[3]-o)}(this,t,e,s),this.check()}multiplyRight(t,e){return i(!e),Et(this,this,t),this.check()}multiplyLeft(t,e){return i(!e),Et(this,t,this),this.check()}normalize(){const t=this.len(),e=t>0?1/t:0;return this[0]=this[0]*e,this[1]=this[1]*e,this[2]=this[2]*e,this[3]=this[3]*e,0===t&&(this[3]=1),this.check()}rotateX(t){return function(t,e,s){s*=.5;var i=e[0],r=e[1],n=e[2],h=e[3],o=Math.sin(s),a=Math.cos(s);t[0]=i*a+h*o,t[1]=r*a+n*o,t[2]=n*a-r*o,t[3]=h*a-i*o}(this,this,t),this.check()}rotateY(t){return function(t,e,s){s*=.5;var i=e[0],r=e[1],n=e[2],h=e[3],o=Math.sin(s),a=Math.cos(s);t[0]=i*a-n*o,t[1]=r*a+h*o,t[2]=n*a+i*o,t[3]=h*a-r*o}(this,this,t),this.check()}rotateZ(t){return function(t,e,s){s*=.5;var i=e[0],r=e[1],n=e[2],h=e[3],o=Math.sin(s),a=Math.cos(s);t[0]=i*a+r*o,t[1]=r*a-i*o,t[2]=n*a+h*o,t[3]=h*a-n*o}(this,this,t),this.check()}scale(t){return function(t,e,s){t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t[3]=e[3]*s}(this,this,t),this.check()}slerp(t,e,s){switch(arguments.length){case 1:({start:t=Pt,target:e,ratio:s}=arguments[0]);break;case 2:[e,s]=arguments,t=this}return function(t,e,s,i){var r,n,h,o,a,c=e[0],u=e[1],l=e[2],d=e[3],f=s[0],p=s[1],w=s[2],g=s[3];(n=c*f+u*p+l*w+d*g)<0&&(n=-n,f=-f,p=-p,w=-w,g=-g),1-n>R?(r=Math.acos(n),h=Math.sin(r),o=Math.sin((1-i)*r)/h,a=Math.sin(i*r)/h):(o=1-i,a=i),t[0]=o*c+a*f,t[1]=o*u+a*p,t[2]=o*l+a*w,t[3]=o*d+a*g}(this,t,e,s),this.check()}transformVector4(t,e=t){return function(t,e,s){var i=e[0],r=e[1],n=e[2],h=s[0],o=s[1],a=s[2],c=s[3],u=c*i+o*n-a*r,l=c*r+a*i-h*n,d=c*n+h*r-o*i,f=-h*i-o*r-a*n;t[0]=u*c+f*-h+l*-a-d*-o,t[1]=l*c+f*-o+d*-h-u*-a,t[2]=d*c+f*-a+u*-o-l*-h,t[3]=e[3]}(e,t,this),V(e,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(t,e){return this.setAxisAngle(t,e)}premultiply(t,e){return this.multiplyLeft(t,e)}multiply(t,e){return this.multiplyRight(t,e)}}const kt={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:2*Math.PI},Vt=1e-6;class _t{constructor({phi:t=0,theta:e=0,radius:s=1,bearing:i,pitch:r,altitude:n,radiusScale:h=6371e3}={}){this.phi=t,this.theta=e,this.radius=s||n||1,this.radiusScale=h||1,void 0!==i&&(this.bearing=i),void 0!==r&&(this.pitch=r),this.check()}toString(){return this.formatString(h)}formatString({printTypes:t=!1}){const e=a;return"".concat(t?"Spherical":"","[rho:").concat(e(this.radius),",theta:").concat(e(this.theta),",phi:").concat(e(this.phi),"]")}equals(t){return x(this.radius,t.radius)&&x(this.theta,t.theta)&&x(this.phi,t.phi)}exactEquals(t){return this.radius===t.radius&&this.theta===t.theta&&this.phi===t.phi}get bearing(){return 180-w(this.phi)}set bearing(t){this.phi=Math.PI-p(t)}get pitch(){return w(this.theta)}set pitch(t){this.theta=p(t)}get longitude(){return w(this.phi)}get latitude(){return w(this.theta)}get lng(){return w(this.phi)}get lat(){return w(this.theta)}get z(){return(this.radius-1)*this.radiusScale}set(t,e,s){return this.radius=t,this.phi=e,this.theta=s,this.check()}clone(){return(new _t).copy(this)}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this.check()}fromLngLatZ([t,e,s]){this.radius=1+s/this.radiusScale,this.phi=p(e),this.theta=p(t)}fromVector3(t){return this.radius=X(t),this.radius>0&&(this.theta=Math.atan2(t[0],t[1]),this.phi=Math.acos(v(t[2]/this.radius,-1,1))),this.check()}toVector3(){return new J(0,0,this.radius).rotateX({radians:this.theta}).rotateZ({radians:this.phi})}makeSafe(){return this.phi=Math.max(Vt,Math.min(Math.PI-Vt,this.phi)),this}check(){if(!(Number.isFinite(this.phi)&&Number.isFinite(this.theta)&&this.radius>0))throw new Error("SphericalCoordinates: some fields set to invalid numbers");return this}}const Tt="Unknown Euler angle order",At=.99999;class Lt extends F{static get ZYX(){return 0}static get YXZ(){return 1}static get XZY(){return 2}static get ZXY(){return 3}static get YZX(){return 4}static get XYZ(){return 5}static get RollPitchYaw(){return 0}static get DefaultOrder(){return Lt.ZYX}static get RotationOrders(){return["ZYX","YXZ","XZY","ZXY","YZX","XYZ"]}static rotationOrder(t){return Lt.RotationOrders[t]}get ELEMENTS(){return 4}constructor(t=0,e=0,s=0,i=Lt.DefaultOrder){super(-0,-0,-0,-0),arguments.length>0&&Array.isArray(arguments[0])?this.fromVector3(...arguments):this.set(t,e,s,i)}fromQuaternion(t){const[e,s,i,r]=t,n=s*s,h=-2*(n+i*i)+1,o=2*(e*s+r*i);let a=-2*(e*i-r*s);const c=2*(s*i+r*e),u=-2*(e*e+n)+1;a=a>1?1:a,a=a<-1?-1:a;const l=Math.atan2(c,u),d=Math.asin(a),f=Math.atan2(o,h);return new Lt(l,d,f,Lt.RollPitchYaw)}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=Number.isFinite(t[3])||this.order,this.check()}set(t=0,e=0,s=0,i){return this[0]=t,this[1]=e,this[2]=s,this[3]=Number.isFinite(i)?i:this[3],this.check()}validate(){return(t=this[3])>=0&&t<6&&Number.isFinite(this[0])&&Number.isFinite(this[1])&&Number.isFinite(this[2]);var t}toArray(t=[],e=0){return t[e]=this[0],t[e+1]=this[1],t[e+2]=this[2],t}toArray4(t=[],e=0){return t[e]=this[0],t[e+1]=this[1],t[e+2]=this[2],t[e+3]=this[3],t}toVector3(t=[-0,-0,-0]){return t[0]=this[0],t[1]=this[1],t[2]=this[2],t}get x(){return this[0]}set x(t){this[0]=k(t)}get y(){return this[1]}set y(t){this[1]=k(t)}get z(){return this[2]}set z(t){this[2]=k(t)}get alpha(){return this[0]}set alpha(t){this[0]=k(t)}get beta(){return this[1]}set beta(t){this[1]=k(t)}get gamma(){return this[2]}set gamma(t){this[2]=k(t)}get phi(){return this[0]}set phi(t){this[0]=k(t)}get theta(){return this[1]}set theta(t){this[1]=k(t)}get psi(){return this[2]}set psi(t){this[2]=k(t)}get roll(){return this[0]}set roll(t){this[0]=k(t)}get pitch(){return this[1]}set pitch(t){this[1]=k(t)}get yaw(){return this[2]}set yaw(t){this[2]=k(t)}get order(){return this[3]}set order(t){this[3]=function(t){if(t<0&&t>=6)throw new Error(Tt);return t}(t)}fromVector3(t,e){return this.set(t[0],t[1],t[2],Number.isFinite(e)?e:this[3])}fromArray(t,e=0){return this[0]=t[0+e],this[1]=t[1+e],this[2]=t[2+e],void 0!==t[3]&&(this[3]=t[3]),this.check()}fromRollPitchYaw(t,e,s){return this.set(t,e,s,Lt.ZYX)}fromRotationMatrix(t,e=Lt.DefaultOrder){return this._fromRotationMatrix(t,e),this.check()}getRotationMatrix(t){return this._getRotationMatrix(t)}getQuaternion(){const t=new Ft;switch(this[3]){case Lt.XYZ:return t.rotateX(this[0]).rotateY(this[1]).rotateZ(this[2]);case Lt.YXZ:return t.rotateY(this[0]).rotateX(this[1]).rotateZ(this[2]);case Lt.ZXY:return t.rotateZ(this[0]).rotateX(this[1]).rotateY(this[2]);case Lt.ZYX:return t.rotateZ(this[0]).rotateY(this[1]).rotateX(this[2]);case Lt.YZX:return t.rotateY(this[0]).rotateZ(this[1]).rotateX(this[2]);case Lt.XZY:return t.rotateX(this[0]).rotateZ(this[1]).rotateY(this[2]);default:throw new Error(Tt)}}_fromRotationMatrix(t,e=Lt.DefaultOrder){const s=t.elements,i=s[0],r=s[4],n=s[8],h=s[1],o=s[5],a=s[9],c=s[2],u=s[6],l=s[10];switch(e=e||this[3]){case Lt.XYZ:this[1]=Math.asin(v(n,-1,1)),Math.abs(n)<At?(this[0]=Math.atan2(-a,l),this[2]=Math.atan2(-r,i)):(this[0]=Math.atan2(u,o),this[2]=0);break;case Lt.YXZ:this[0]=Math.asin(-v(a,-1,1)),Math.abs(a)<At?(this[1]=Math.atan2(n,l),this[2]=Math.atan2(h,o)):(this[1]=Math.atan2(-c,i),this[2]=0);break;case Lt.ZXY:this[0]=Math.asin(v(u,-1,1)),Math.abs(u)<At?(this[1]=Math.atan2(-c,l),this[2]=Math.atan2(-r,o)):(this[1]=0,this[2]=Math.atan2(h,i));break;case Lt.ZYX:this[1]=Math.asin(-v(c,-1,1)),Math.abs(c)<At?(this[0]=Math.atan2(u,l),this[2]=Math.atan2(h,i)):(this[0]=0,this[2]=Math.atan2(-r,o));break;case Lt.YZX:this[2]=Math.asin(v(h,-1,1)),Math.abs(h)<At?(this[0]=Math.atan2(-a,o),this[1]=Math.atan2(-c,i)):(this[0]=0,this[1]=Math.atan2(n,l));break;case Lt.XZY:this[2]=Math.asin(-v(r,-1,1)),Math.abs(r)<At?(this[0]=Math.atan2(u,o),this[1]=Math.atan2(n,i)):(this[0]=Math.atan2(-a,l),this[1]=0);break;default:throw new Error(Tt)}return this[3]=e,this}_getRotationMatrix(t){const e=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],s=this.x,i=this.y,r=this.z,n=Math.cos(s),h=Math.cos(i),o=Math.cos(r),a=Math.sin(s),c=Math.sin(i),u=Math.sin(r);switch(this[3]){case Lt.XYZ:{const t=n*o,s=n*u,i=a*o,r=a*u;e[0]=h*o,e[4]=-h*u,e[8]=c,e[1]=s+i*c,e[5]=t-r*c,e[9]=-a*h,e[2]=r-t*c,e[6]=i+s*c,e[10]=n*h;break}case Lt.YXZ:{const t=h*o,s=h*u,i=c*o,r=c*u;e[0]=t+r*a,e[4]=i*a-s,e[8]=n*c,e[1]=n*u,e[5]=n*o,e[9]=-a,e[2]=s*a-i,e[6]=r+t*a,e[10]=n*h;break}case Lt.ZXY:{const t=h*o,s=h*u,i=c*o,r=c*u;e[0]=t-r*a,e[4]=-n*u,e[8]=i+s*a,e[1]=s+i*a,e[5]=n*o,e[9]=r-t*a,e[2]=-n*c,e[6]=a,e[10]=n*h;break}case Lt.ZYX:{const t=n*o,s=n*u,i=a*o,r=a*u;e[0]=h*o,e[4]=i*c-s,e[8]=t*c+r,e[1]=h*u,e[5]=r*c+t,e[9]=s*c-i,e[2]=-c,e[6]=a*h,e[10]=n*h;break}case Lt.YZX:{const t=n*h,s=n*c,i=a*h,r=a*c;e[0]=h*o,e[4]=r-t*u,e[8]=i*u+s,e[1]=u,e[5]=n*o,e[9]=-a*o,e[2]=-c*o,e[6]=s*u+i,e[10]=t-r*u;break}case Lt.XZY:{const t=n*h,s=n*c,i=a*h,r=a*c;e[0]=h*o,e[4]=-u,e[8]=c*o,e[1]=t*u+r,e[5]=n*o,e[9]=s*u-i,e[2]=i*u-s,e[6]=a*o,e[10]=r*u+t;break}default:throw new Error(Tt)}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}toQuaternion(){const t=Math.cos(.5*this.yaw),e=Math.sin(.5*this.yaw),s=Math.cos(.5*this.roll),i=Math.sin(.5*this.roll),r=Math.cos(.5*this.pitch),n=Math.sin(.5*this.pitch);return new Ft(t*i*r-e*s*n,t*s*n+e*i*r,e*s*r-t*i*n,t*s*r+e*i*n)}}class Rt{constructor({x:t=0,y:e=0,z:s=0,roll:i=0,pitch:r=0,yaw:n=0,position:h,orientation:o}={}){Array.isArray(h)&&3===h.length?this.position=new J(h):this.position=new J(t,e,s),Array.isArray(o)&&4===o.length?this.orientation=new Lt(o,o[3]):this.orientation=new Lt(i,r,n,Lt.RollPitchYaw)}get x(){return this.position.x}set x(t){this.position.x=t}get y(){return this.position.y}set y(t){this.position.y=t}get z(){return this.position.z}set z(t){this.position.z=t}get roll(){return this.orientation.roll}set roll(t){this.orientation.roll=t}get pitch(){return this.orientation.pitch}set pitch(t){this.orientation.pitch=t}get yaw(){return this.orientation.yaw}set yaw(t){this.orientation.yaw=t}getPosition(){return this.position}getOrientation(){return this.orientation}equals(t){return!!t&&this.position.equals(t.position)&&this.orientation.equals(t.orientation)}exactEquals(t){return!!t&&this.position.exactEquals(t.position)&&this.orientation.exactEquals(t.orientation)}getTransformationMatrix(){const t=Math.sin(this.roll),e=Math.sin(this.pitch),s=Math.sin(this.yaw),i=Math.cos(this.roll),r=Math.cos(this.pitch),n=Math.cos(this.yaw);return(new gt).setRowMajor(n*r,-s*i+n*e*t,s*t+n*e*i,this.x,s*r,n*i+s*e*t,-n*t+s*e*i,this.y,-e,r*t,r*i,this.z,0,0,0,1)}getTransformationMatrixFromPose(t){return(new gt).multiplyRight(this.getTransformationMatrix()).multiplyRight(t.getTransformationMatrix().invert())}getTransformationMatrixToPose(t){return(new gt).multiplyRight(t.getTransformationMatrix()).multiplyRight(this.getTransformationMatrix().invert())}}const Nt="undefined"!=typeof self&&self,It="undefined"!=typeof window&&window;(void 0!==s.g&&s.g||Nt||It).mathgl={config:h}},434:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=i(s(291));e.default=class{constructor(t){this.uri=t}async getImageData(t,e){return this.loadFile().then((async s=>{const i=await createImageBitmap(s),n=document.createElement("canvas"),h=n.getContext("2d");return n.width=e.width/r.default.SCALE,n.height=e.height/r.default.SCALE,h.drawImage(i,t.x,t.y,n.width,n.height,0,0,n.width,n.height),h.getImageData(0,0,n.width,n.height).data}))}async loadFile(){const t=await fetch(this.uri),e=await t.blob();return new File([e],"level.png",e)}}},696:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(648),n=i(s(319));e.default=class{static getAllChunks(){return[{spawnPoint:new r.Vector2(384,128),escapePoint:new r.Vector2(784,336),bitmapPos:new r.Vector2(0,0)},{spawnPoint:new r.Vector2(n.default.OFFSET/2,336),escapePoint:new r.Vector2(784,336),bitmapPos:new r.Vector2(25,0)},{spawnPoint:new r.Vector2(n.default.OFFSET/2,336),escapePoint:[new r.Vector2(1*n.default.OFFSET,496),new r.Vector2(2*n.default.OFFSET,496),new r.Vector2(3*n.default.OFFSET,496),new r.Vector2(4*n.default.OFFSET,496)],bitmapPos:new r.Vector2(50,0)},{spawnPoint:new r.Vector2(96,n.default.OFFSET),escapePoint:[new r.Vector2(1*n.default.OFFSET,496),new r.Vector2(2*n.default.OFFSET,496),new r.Vector2(3*n.default.OFFSET,496),new r.Vector2(4*n.default.OFFSET,496)],bitmapPos:new r.Vector2(75,0)},{spawnPoint:new r.Vector2(96,n.default.OFFSET),escapePoint:new r.Vector2(784,272),bitmapPos:new r.Vector2(0,16)},{spawnPoint:new r.Vector2(n.default.OFFSET/2,272),escapePoint:new r.Vector2(784,272),bitmapPos:new r.Vector2(25,16)},{spawnPoint:new r.Vector2(n.default.OFFSET/2,272),escapePoint:[new r.Vector2(21*n.default.OFFSET,496),new r.Vector2(22*n.default.OFFSET,496),new r.Vector2(23*n.default.OFFSET,496),new r.Vector2(24*n.default.OFFSET,496)],bitmapPos:new r.Vector2(50,16)},{spawnPoint:new r.Vector2(9*n.default.OFFSET,n.default.OFFSET),escapePoint:[new r.Vector2(8*n.default.OFFSET,496),new r.Vector2(9*n.default.OFFSET,496),new r.Vector2(10*n.default.OFFSET,496),new r.Vector2(11*n.default.OFFSET,496),new r.Vector2(12*n.default.OFFSET,496),new r.Vector2(13*n.default.OFFSET,496),new r.Vector2(14*n.default.OFFSET,496)],bitmapPos:new r.Vector2(75,16)},{spawnPoint:new r.Vector2(13*n.default.OFFSET,n.default.OFFSET),escapePoint:new r.Vector2(784,368),bitmapPos:new r.Vector2(0,32)},{spawnPoint:new r.Vector2(n.default.OFFSET,368),escapePoint:[new r.Vector2(21*n.default.OFFSET,496),new r.Vector2(22*n.default.OFFSET,496),new r.Vector2(23*n.default.OFFSET,496)],bitmapPos:new r.Vector2(25,32)},{spawnPoint:new r.Vector2(23*n.default.OFFSET,n.default.OFFSET),escapePoint:new r.Vector2(784,304),bitmapPos:new r.Vector2(50,32)},{spawnPoint:new r.Vector2(n.default.OFFSET/2,304),escapePoint:new r.Vector2(784,80),bitmapPos:new r.Vector2(75,32)},{spawnPoint:new r.Vector2(n.default.OFFSET/2,80),escapePoint:new r.Vector2(784,368),bitmapPos:new r.Vector2(0,48)},{spawnPoint:new r.Vector2(n.default.OFFSET/2,368),escapePoint:[new r.Vector2(13*n.default.OFFSET,496),new r.Vector2(14*n.default.OFFSET,496),new r.Vector2(15*n.default.OFFSET,496),new r.Vector2(16*n.default.OFFSET,496),new r.Vector2(17*n.default.OFFSET,496),new r.Vector2(18*n.default.OFFSET,496),new r.Vector2(19*n.default.OFFSET,496),new r.Vector2(20*n.default.OFFSET,496),new r.Vector2(21*n.default.OFFSET,496)],bitmapPos:new r.Vector2(25,48)},{spawnPoint:new r.Vector2(15*n.default.OFFSET,n.default.OFFSET),escapePoint:[new r.Vector2(9*n.default.OFFSET,496),new r.Vector2(10*n.default.OFFSET,496),new r.Vector2(11*n.default.OFFSET,496),new r.Vector2(12*n.default.OFFSET,496),new r.Vector2(13*n.default.OFFSET,496),new r.Vector2(14*n.default.OFFSET,496),new r.Vector2(15*n.default.OFFSET,496),new r.Vector2(16*n.default.OFFSET,496),new r.Vector2(17*n.default.OFFSET,496),new r.Vector2(18*n.default.OFFSET,496)],bitmapPos:new r.Vector2(50,48)},{spawnPoint:new r.Vector2(14*n.default.OFFSET,n.default.OFFSET),escapePoint:[new r.Vector2(7*n.default.OFFSET,496),new r.Vector2(8*n.default.OFFSET,496),new r.Vector2(9*n.default.OFFSET,496),new r.Vector2(17*n.default.OFFSET,496),new r.Vector2(18*n.default.OFFSET,496),new r.Vector2(19*n.default.OFFSET,496)],bitmapPos:new r.Vector2(75,48)},{spawnPoint:new r.Vector2(20*n.default.OFFSET,n.default.OFFSET),escapePoint:new r.Vector2(779,432),bitmapPos:new r.Vector2(0,64)},{spawnPoint:new r.Vector2(n.default.OFFSET,432),escapePoint:new r.Vector2(24*n.default.OFFSET+n.default.OFFSET/2,400),bitmapPos:new r.Vector2(25,64)},{spawnPoint:new r.Vector2(n.default.OFFSET,400),escapePoint:new r.Vector2(24*n.default.OFFSET+n.default.OFFSET/2,400),bitmapPos:new r.Vector2(50,64)},{spawnPoint:new r.Vector2(n.default.OFFSET,400),escapePoint:new r.Vector2(24*n.default.OFFSET+n.default.OFFSET/2,400),bitmapPos:new r.Vector2(75,64)},{spawnPoint:new r.Vector2(n.default.OFFSET,400),escapePoint:new r.Vector2(24*n.default.OFFSET+n.default.OFFSET/2,336),bitmapPos:new r.Vector2(0,80)},{spawnPoint:new r.Vector2(n.default.OFFSET,336),escapePoint:new r.Vector2(24*n.default.OFFSET+n.default.OFFSET/2,80),bitmapPos:new r.Vector2(25,80)},{spawnPoint:new r.Vector2(n.default.OFFSET,80),escapePoint:[new r.Vector2(15*n.default.OFFSET,496),new r.Vector2(16*n.default.OFFSET,496),new r.Vector2(17*n.default.OFFSET,496)],bitmapPos:new r.Vector2(50,80)},{spawnPoint:new r.Vector2(15*n.default.OFFSET,n.default.OFFSET),escapePoint:new r.Vector2(784,432),bitmapPos:new r.Vector2(75,80)},{spawnPoint:new r.Vector2(n.default.OFFSET,432),escapePoint:[new r.Vector2(21*n.default.OFFSET,496),new r.Vector2(22*n.default.OFFSET,496),new r.Vector2(23*n.default.OFFSET,496)],bitmapPos:new r.Vector2(0,96)},{spawnPoint:new r.Vector2(22*n.default.OFFSET,n.default.OFFSET),escapePoint:[],bitmapPos:new r.Vector2(25,96)}]}}},862:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=i(s(974)),n=i(s(661)),h=i(s(291));class o extends n.default{constructor(t,e){super(t,e),this.then=performance.now(),this.width=t,this.height=e,this.context=this.getInstance(),this.gameScreen=new h.default(this.context),this.run()}run(){r.default.disableImageSmoothing(this.context),this.gameScreen.init(),this.lockMousePointer(),window.requestAnimationFrame((t=>this.tick(t)))}tick(t){r.default.clearRect(this.context,this.width,this.height);const e=1e3/o.MAX_FPS,s=t-this.then;s>=e-.1&&(this.then=t-s%e,this.gameScreen.tick(),this.render()),this.gameScreen.playerDead||window.requestAnimationFrame((t=>this.tick(t)))}render(){this.gameScreen.render()}}o.MAX_FPS=60,new o(800,512)},319:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(648),n=i(s(974)),h=i(s(777)),o=i(s(836)),a=i(s(126)),c=i(s(282)),u=i(s(148)),l=i(s(677)),d=i(s(111)),f=i(s(317)),p=i(s(947)),w=i(s(434)),g=i(s(134)),m=i(s(696)),y=s(584),E=s(209),M=i(s(692)),S=i(s(92)),v=i(s(343));class O{constructor(t){this.currentChunk=0,this.chunksData=m.default.getAllChunks(),this.renderables=new Array,this.collidables=new Array,this.pixels=new Array,this.bitmap=new w.default("../../assets/img/level.png"),this.context=t}init(){this.loadPixels(),this.addBlocks()}refresh(){this.pixels=[],this.collidables=[],this.renderables=this.renderables.filter((t=>t instanceof d.default)),this.loadPixels(),this.addBlocks()}getPlayer(){return this.renderables.filter((t=>t instanceof d.default))[0]}addBlocks(){this.loadPixels().then((()=>{this.pixels.forEach((t=>{switch(console.log(this.pixels),t.colorHex){case 4278190335:this.add(new h.default(this,t.pos));break;case 1082163455:this.add(new h.default(this,t.pos,1));break;case 2398286591:this.add(new o.default(this,t.pos));break;case 4278223103:this.add(new o.default(this,t.pos,1));break;case 3422552319:this.add(new o.default(this,t.pos,2));break;case 4286595327:this.add(new S.default(this,t.pos));break;case 4289645055:this.add(new S.default(this,t.pos,1));break;case 8388863:this.add(new a.default(this,t.pos));break;case 1073758463:this.add(new a.default(this,t.pos,1));break;case 3368019967:this.add(new c.default(this,t.pos));break;case 3922528255:this.add(new c.default(this,t.pos,1));break;case 1035519:this.add(new c.default(this,t.pos,2));break;case 2164260863:this.add(new v.default(this,t.pos));break;case 3822306559:this.add(new v.default(this,t.pos,1));break;case 2739512575:this.add(new u.default(this,t.pos));break;case 3284386815:this.add(new f.default(this,new r.Vector2(16,0),t.pos,0));break;case 3301229823:this.add(new f.default(this,new r.Vector2(48,0),t.pos,1));break;case 868653823:this.add(new l.default(this,new r.Vector2(112,0),t.pos,1));break;case 2768117247:this.add(new p.default(this,new r.Vector2(96,0),t.pos,1));break;case 2768117503:this.add(new p.default(this,new r.Vector2(96,0),t.pos,2));break;case 1073742079:this.add(new M.default(this,new r.Vector2(128,0),t.pos));break;case 2315981311:this.add(new y.Hearth(this,t.pos));break;case 1597390335:this.add(new E.Gun(this,t.pos))}}))}))}add(t){return this.renderables.push(t),"isCollidable"in t?(this.collidables.push(t),t):t}remove(t){this.renderables=this.renderables.filter((e=>t.pos!==e.pos))}getAllRenderables(){return this.renderables}getAllCollidables(){return this.collidables}render(){n.default.disableImageSmoothing(this.context),this.getAllRenderables().forEach((t=>t.render()))}async loadPixels(){return this.bitmap.getImageData(this.chunksData[this.currentChunk].bitmapPos,this.context.canvas).then((t=>{const e=new r.Vector2(0,0);for(let s=4;s<=t.length;s+=4){const i=Array.from(t.subarray(s-4,s));e.x>=25&&(e.x=0,e.y++),this.pixels.push(new g.default(new r.Vector2(e.x,e.y),new r.Vector4(i))),e.x++}this.pixels=this.pixels.filter(((t,e,s)=>e===s.findIndex((e=>e.pos.equals(t.pos.elements)))))}))}}e.default=O,O.OFFSET=32},134:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=i(s(6)),n=i(s(291));e.default=class{constructor(t,e){this.pos=t.multiplyByScalar(n.default.SCALE),this.color=e,this.colorHex=r.default.rgba2Hex(e)}}},443:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t){this.width=0,this.height=0,this.loaded=!0,this.url=t}load(){const t=new Image;return t.onload=e=>{this.width=t.width,this.height=t.height,this.loaded=!0},t.src=this.url?this.url:"",t}}},314:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(648),n=i(s(974)),h=i(s(319));e.default=class{constructor(){this.lastTime=(new Date).getTime(),this.numSeconds=0}render(t,e){const s=t.canvas,i=(new Date).getTime();i-this.lastTime>=1e3&&(this.lastTime=i,e||this.numSeconds++);const o=new r.Vector2(s.width/2-h.default.OFFSET,h.default.OFFSET/2),a=new r.Vector4(255,255,255,1);let c=Math.floor(this.numSeconds/60);c=c<10?"0"+c:c;let u=this.numSeconds-60*c;u=u<10?"0"+u:u,n.default.renderText(t,`${c} ${u}`,"16px MMRock9",o,t.canvas.width,a)}}},478:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(648),n=i(s(974)),h=i(s(443));e.default=class{constructor(t,e){this.size=new r.Vector2(32,32),this.spriteSheet=new h.default("../assets/img/blocks.png"),this.sSize=this.size.clone().divideScalar(2),this.pos=e,this.isCollidable=!0,this.img=this.spriteSheet.load(),this.level=t}render(){n.default.drawImage(this.level.context,this.img,this.sPos,this.sSize.clone().sub(new r.Vector2(1,0)),this.pos,this.size)}}},777:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(648),n=i(s(478));class h extends n.default{constructor(t,e,s=0){super(t,e),this.sPos=new r.Vector2(0,0),this.variant=s}render(){switch(this.variant){case 0:this.sPos=new r.Vector2(0,0);break;case 1:this.sPos=new r.Vector2(32,0)}super.render()}}e.default=h},92:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(648),n=i(s(974)),h=i(s(777));class o extends h.default{constructor(t,e,s=0){super(t,e,s)}render(){switch(this.variant){case 0:this.sPos=new r.Vector2(160,0);break;case 1:this.sPos=new r.Vector2(192,0)}n.default.drawImage(this.level.context,this.img,this.sPos,this.sSize,this.pos,this.size)}}e.default=o},343:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(648),n=i(s(974)),h=i(s(126));class o extends h.default{constructor(t,e,s=0){super(t,e,s)}render(){switch(this.variant){case 0:this.sPos=new r.Vector2(176,0);break;case 1:this.sPos=new r.Vector2(208,0)}n.default.drawImage(this.level.context,this.img,this.sPos,this.sSize,this.pos,this.size)}}e.default=o},836:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(648),n=i(s(974)),h=i(s(777));class o extends h.default{constructor(t,e,s=0){super(t,e,s)}render(){switch(this.variant){case 0:this.sPos=new r.Vector2(64,0);break;case 1:this.sPos=new r.Vector2(96,0);break;case 2:this.sPos=new r.Vector2(128,0)}n.default.drawImage(this.level.context,this.img,this.sPos,this.sSize,this.pos,this.size)}}e.default=o},282:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(648),n=i(s(974)),h=i(s(126));class o extends h.default{constructor(t,e,s=0){super(t,e,s)}render(){switch(this.variant){case 0:this.sPos=new r.Vector2(80,0);break;case 1:this.sPos=new r.Vector2(112,0);break;case 2:this.sPos=new r.Vector2(144,0)}n.default.drawImage(this.level.context,this.img,this.sPos,this.sSize,this.pos,this.size)}}e.default=o},148:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(648),n=i(s(478));class h extends n.default{constructor(t,e){super(t,e),this.variant=0,this.sPos=new r.Vector2(0,16)}}e.default=h},126:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(648),n=i(s(478));class h extends n.default{constructor(t,e,s=0){super(t,e),this.sPos=new r.Vector2(16,0),this.variant=s}render(){switch(this.variant){case 0:this.sPos=new r.Vector2(16,0);break;case 1:this.sPos=new r.Vector2(48,0)}super.render()}}e.default=h},661:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t,e){this.width=t,this.height=e}getInstance(){const t=document.querySelector("#game");t.width=this.width,t.height=this.height;const e=t.getContext("2d");if(null===e)throw"Your browser don't support canvas :(";return e}lockMousePointer(){const t=this.getInstance().canvas;document.onclick=e=>t.requestPointerLock()}static sleep(t){const e=(new Date).getTime();for(;(new Date).getTime()<e+t;);}}},740:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});const i=s(402);e.default=class{static getPseduoKeyCode(t){let e=null;switch(t){case"KeyW":e=i.Keys.W;break;case"KeyA":e=i.Keys.A;break;case"KeyS":e=i.Keys.S;break;case"KeyD":e=i.Keys.D;break;case"KeyE":e=i.Keys.E}return e}}},354:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(648),n=i(s(319)),h=i(s(686)),o=i(s(851)),a=i(s(987)),c=i(s(111));class u extends a.default{constructor(t,e,s,i,n){super(t,new r.Vector2(0,0),e),this.size=new r.Vector2(12,12),this.level=t,this.speed=4*s,this.direction=i,this.source=n}render(){this.tick(),this.source instanceof c.default&&(this.sPos.x=n.default.OFFSET/2*12),super.render()}tick(){if(!super.isInChunk()||super.intersects()&&this.source instanceof c.default)this.level.remove(this);else if(this.source instanceof c.default)for(const t of this.level.getAllRenderables())t instanceof o.default&&h.default.intersects(this,t)&&(t.health--,this.level.remove(this));else if(!(this.source instanceof c.default)){const t=this.level.getPlayer();h.default.intersects(t,this)&&(t.getDamage(),this.level.remove(this))}this.setDirection(this.direction)}setDirection(t){switch(this.direction){case 0:this.pos.x-=this.speed;break;case 1:this.pos.x+=this.speed;break;case 2:this.pos.x-=this.speed,this.pos.y-=this.speed;break;case 3:this.pos.x+=this.speed,this.pos.y-=this.speed;break;case 4:this.pos.x+=this.speed,this.pos.y+=this.speed;break;case 5:this.pos.x-=this.speed,this.pos.y+=this.speed}}}e.default=u},851:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=i(s(686)),n=i(s(987));class h extends n.default{constructor(t,e,s){super(t,e,s),this.moving=!1}tick(){this.health<=0&&this.level.remove(this),this.hurtsPlayer()}updateDirection(){const t=super.getCollisionFace();"l"===t?(this.direction=0,this.moving=!1):"r"===t?(this.direction=1,this.moving=!1):"b"===t?(this.direction=2,this.moving=!1):"t"===t&&(this.direction=3,this.moving=!1)}hurtsPlayer(){const t=this.level.getPlayer();r.default.intersects(t,this)&&t.getDamage()}tryMove(){this.updateDirection(),0===this.direction?this.pos.x-=this.speed:1===this.direction?this.pos.x+=this.speed:2===this.direction?this.pos.y-=this.speed:3===this.direction&&(this.pos.y+=this.speed)}}e.default=h},987:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(648),n=i(s(974)),h=i(s(686)),o=i(s(319)),a=i(s(443)),c=i(s(291));e.default=class{constructor(t,e,s){this.sSize=new r.Vector2(c.default.SCALE/2,c.default.SCALE/2),this.size=new r.Vector2(c.default.SCALE,c.default.SCALE),this.spriteSheet=new a.default("../assets/img/entities.png"),this.direction=0,this.health=3,this.sPos=e,this.pos=s,this.img=this.spriteSheet.load(),this.level=t}render(){n.default.drawImage(this.level.context,this.img,new r.Vector2(Math.floor(this.sPos.x),Math.floor(this.sPos.y)),this.sSize,this.pos,this.size)}isColliding(){for(const t of this.level.getAllCollidables())if(null!==h.default.checkCollision(this,t))return!0;return!1}getCollisionFace(){for(const t of this.level.getAllCollidables()){const e=h.default.checkCollision(this,t);if(null!==e)return e}return null}intersects(){for(const t of this.level.getAllCollidables())if(h.default.intersects(this,t))return!0;return!1}isInChunk(){const t=this.level.context.canvas,e=o.default.OFFSET/2,s=new r.Vector2(e,e),i=new r.Vector2(t.width-e,t.height-e);return this.pos.x>s.x&&this.pos.x<i.x&&this.pos.y>s.y&&this.pos.y<i.y}}},692:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(648),n=i(s(6)),h=i(s(354)),o=i(s(851));class a extends o.default{constructor(t,e,s){super(t,e,s),this.direction=0,this.shooting=!1,this.sPosA=this.sPos.clone()}render(){this.tick();const t=this.level.getPlayer();t.pos.x<this.pos.x?this.direction=0:t.pos.x>this.pos.x&&(this.direction=1),0===this.direction?this.sPos.x=this.shooting?144:128:1===this.direction&&(this.sPos.x=this.shooting?160:176),super.render()}tick(){!this.shooting&&n.default.randomRange(0,1e3)<5?this.tryShoot():this.shooting&&n.default.randomRange(0,100)<3&&(this.shooting=!1),super.tick()}tryShoot(){this.shooting=!0,this.level.add(new h.default(this.level,this.pos.clone().sub(new r.Vector2(0,8)),.6,this.direction,this))}}e.default=a},677:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=i(s(851));class n extends r.default{constructor(t,e,s,i){super(t,e,s),this.moving=!0,this.speed=1.5,this.direction=i}render(){this.tick(),super.render()}tick(){this.tryMove(),super.tick()}updateDirection(){const t=super.getCollisionFace();"l"===t?this.direction=0:"r"===t&&(this.direction=1)}}e.default=n},111:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(648),n=i(s(974)),h=i(s(6)),o=s(402),a=i(s(740)),c=i(s(291)),u=i(s(686)),l=i(s(148)),d=i(s(319)),f=i(s(443)),p=i(s(354)),w=i(s(987));class g extends w.default{constructor(t,e,s){super(t,e,s),this.size=new r.Vector2(c.default.SCALE,c.default.SCALE+c.default.SCALE/2),this.sSize=new r.Vector2(c.default.SCALE,c.default.SCALE+c.default.SCALE/2),this.spriteSheet=new f.default("../assets/img/player.png"),this.health=50,this.direction=null,this.jumping=!1,this.falling=!1,this.grounded=!0,this.hurted=!1,this.shooting=!1,this.hasGun=!1,this.alive=!0,this.movingLeft=!1,this.movingRight=!1,this.speed=new r.Vector2(5,6),this.keysDown=new Array,this.posA=new r.Vector2,this.level=t,this.img=this.spriteSheet.load(),this.speedA=this.speed.clone(),window.onkeydown=t=>this.onKeyDown(t),window.onkeyup=t=>this.onKeyUp(t)}render(){let t=0;this.sPos=new r.Vector2(192,48),this.alive&&(this.jumping||this.falling?t=1*c.default.SCALE:this.movingRight?t=2*c.default.SCALE:this.movingLeft?t=3*c.default.SCALE:0===this.direction?t=5*c.default.SCALE:1===this.direction&&(t=4*c.default.SCALE),this.sPos=new r.Vector2(t,0),this.hurted?this.sPos=new r.Vector2(t,this.size.y):this.hasGun?this.sPos=new r.Vector2(t,2*this.size.y):this.hurted&&this.hasGun&&(this.sPos=new r.Vector2(t,3*this.size.y))),this.sSize=this.size,n.default.drawImage(this.level.context,this.img,this.sPos,this.sSize,this.pos,this.size)}tick(){this.health<=0&&(this.alive=!1),this.keyboardMove();const t=this.level.context.canvas,e=d.default.OFFSET/2,s=new r.Vector2(e,e),i=new r.Vector2(t.width-e,t.height-e),n=this.level.chunksData[this.level.currentChunk];if(!Array.isArray(n.escapePoint)||n.escapePoint instanceof r.Vector2)h.default.isInRange(this.pos.x,[n.escapePoint.x-c.default.SCALE,n.escapePoint.x])&&h.default.isInRange(this.pos.y,[n.escapePoint.y-c.default.SCALE,n.escapePoint.y])&&this.goToNextChunk();else for(const t of n.escapePoint)h.default.isInRange(this.pos.x,[t.x-c.default.SCALE,t.x])&&h.default.isInRange(this.pos.y,[t.y-c.default.SCALE,t.y])&&this.goToNextChunk();this.pos.x<s.x&&(this.pos.x=s.x),this.pos.x>i.x&&(this.pos.x=i.x),this.pos.y>i.y&&(this.pos.y=i.y);for(const t of this.level.getAllCollidables()){const e=u.default.checkCollision(this,t);if(null!==e)switch(t instanceof l.default&&(this.alive=!1),e){case"b":this.jumping&&(this.falling=!0,this.jumping=!1);break;case"t":this.falling&&(this.grounded=!0,this.falling=!1)}}this.grounded&&!this.intersects()&&(this.grounded=!1,this.falling=!0),this.falling&&!this.grounded&&(this.pos.y+=this.speed.x),this.speed=this.speedA,this.tryJump()}getDamage(){this.hurted=!0,this.health--,setTimeout((()=>this.hurted=!1),500)}keyboardMove(){this.keysDown[o.Keys.W]&&this.grounded&&(this.posA=new r.Vector2(this.pos.x,this.pos.y),this.jumping=!0),this.keysDown[o.Keys.A]&&(this.pos.x-=this.speed.x,this.movingLeft=!0,this.movingRight=!1,this.direction=0),this.keysDown[o.Keys.D]&&(this.pos.x+=this.speed.x,this.movingLeft=!1,this.movingRight=!0,this.direction=1),this.keysDown[o.Keys.E]&&this.hasGun&&!this.shooting&&null!==this.direction&&this.tryShoot(),this.keysDown.find((t=>!0===t))||(this.shooting=!1,this.movingLeft=!1,this.movingRight=!1)}tryJump(){this.jumping&&(this.grounded=!1,this.falling=!1,this.pos.y-=this.speed.y,this.pos.y<this.posA.y-96&&(this.jumping=!1,this.falling=!0))}tryShoot(){this.shooting=!0,this.level.add(new p.default(this.level,this.pos.clone(),.5,this.direction,this))}goToNextChunk(){this.level.currentChunk++,this.pos=this.level.chunksData[this.level.currentChunk].spawnPoint.clone(),this.level.refresh()}onKeyDown(t){const e=a.default.getPseduoKeyCode(t.code);null!==e&&(this.keysDown[e]=!0)}onKeyUp(t){const e=a.default.getPseduoKeyCode(t.code);null!==e&&(this.keysDown[e]=!1)}}e.default=g},317:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(648),n=i(s(6)),h=i(s(319)),o=i(s(354)),a=i(s(851));class c extends a.default{constructor(t,e,s,i){super(t,e,s),this.shooting=!1,this.direction=i,this.sPosA=this.sPos.clone()}render(){this.tick();const t=h.default.OFFSET/2;this.sPos=this.sPosA.clone(),this.shooting&&0===this.direction?this.sPos.x=2*t:this.shooting&&1===this.direction&&(this.sPos.x=4*t),super.render()}tick(){!this.shooting&&n.default.randomRange(0,1e3)<5?this.tryShoot():this.shooting&&n.default.randomRange(0,100)<3&&(this.shooting=!1),super.tick()}tryShoot(){this.shooting=!0,this.level.add(new o.default(this.level,this.pos.clone().sub(new r.Vector2(0,8)),.6,0===this.direction?3:2,this)),this.level.add(new o.default(this.level,this.pos.clone().add(new r.Vector2(0,16)),.6,0===this.direction?4:5,this))}}e.default=c},947:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(648),n=i(s(6)),h=i(s(851));class o extends h.default{constructor(t,e,s,i){super(t,e,s),this.speed=1.25,this.direction=i}render(){this.tick(),this.sPos=new r.Vector2(96,0),this.moving&&(this.sPos=new r.Vector2(80,0)),super.render()}tick(){0===n.default.randomRange(0,256)&&(this.moving=!0),this.moving&&this.tryMove(),super.tick()}}e.default=o},402:(t,e)=>{var s;Object.defineProperty(e,"__esModule",{value:!0}),e.Keys=void 0,(s=e.Keys||(e.Keys={}))[s.W=0]="W",s[s.A=1]="A",s[s.S=2]="S",s[s.D=3]="D",s[s.E=4]="E"},974:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});class s extends CanvasRenderingContext2D{static renderRect(t,e,s,i,r=!1){this.resetFillStyle(t),t.fillStyle=this.getColor(i).toString(),t.fillRect(e.x,e.y,s.x,s.y),r&&t.strokeRect(e.x,e.y,s.x,s.y),this.resetFillStyle(t)}static renderCircle(t,e,s,i,r=!1,n=!0){this.resetFillStyle(t),t.beginPath(),t.fillStyle=this.getColor(i).toString(),t.arc(e.x,e.y,s.x+s.y??0,0,2*Math.PI),n&&t.fill(),r&&t.stroke(),this.resetFillStyle(t)}static renderText(t,e,s,i,r,n){t.font=s,t.fillStyle=this.getColor(n),t.fillText(e,i.x,i.y,r),this.resetTextSettings(t)}static renderShadows(t,e,s,i){t.shadowColor=e,t.shadowBlur=s,t.shadowOffsetX=i.x,t.shadowOffsetY=i.y}static drawImage(t,e,s,i,r,n){t.drawImage(e,s.x,s.y,i.x,i.y,r.x,r.y,n.x,n.y)}static disableImageSmoothing(t){t.imageSmoothingEnabled=!1}static clearRect(t,e,s){t.clearRect(0,0,e,s)}static resetImageSmoothing(t){t.imageSmoothingEnabled=!0}static resetShadows(t){t.shadowColor="rgba(0, 0, 0, 0.0)",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0}static resetFillStyle(t){t.fillStyle="rgb(0, 0, 0)"}static resetTextSettings(t){t.font="10px sans-serif",s.resetFillStyle(t)}static getColor(t){return`rgba(${t.x}, ${t.y}, ${t.z}, ${t.w})`}}e.default=s},6:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});class s{static range(t,e){const s=[];for(let i=t;i<=e;i++)s.push(i);return s}static isInRange(t,e){return t>=e[0]&&t<=e[1]}static randomRange(t,e){return Math.floor(Math.random()*(e-t+1)+t)}static newGuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))}static rgba2Hex(t){let e="";for(const i of t.elements)e+=s.rgbaValue2Hex(i);return parseInt("0x"+e)}static rgbaValue2Hex(t){let e=Number(t).toString(16);return e.length<2&&(e="0"+e),e}}e.default=s},209:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Gun=void 0;const r=s(648),n=i(s(630));class h extends n.default{constructor(t,e){super(t,e),this.sPos=new r.Vector2(16,0)}render(){this.tick((t=>t.hasGun=!0)),super.render()}}e.Gun=h},584:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Hearth=void 0;const r=s(648),n=i(s(630));class h extends n.default{constructor(t,e){super(t,e),this.sPos=new r.Vector2(0,0)}render(){this.tick((t=>t.health++)),super.render()}}e.Hearth=h},630:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(648),n=i(s(974)),h=i(s(686)),o=i(s(111)),a=i(s(443));e.default=class{constructor(t,e){this.spriteSheet=new a.default("../assets/img/items.png"),this.pos=e.addScalar(16),this.size=new r.Vector2(16,16),this.sSize=this.size.clone(),this.img=this.spriteSheet.load(),this.level=t}render(){n.default.drawImage(this.level.context,this.img,new r.Vector2(Math.floor(this.sPos.x),Math.floor(this.sPos.y)),this.sSize,this.pos,this.size)}tick(t){for(const e of this.level.getAllRenderables())e instanceof o.default&&h.default.intersects(e,this)&&(t(e),this.level.remove(this))}}},686:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(648),n=i(s(111));e.default=class{static checkCollision(t,e){const s=t.pos.x+t.size.x/2-(e.pos.x+e.size.x/2),i=t.pos.y+t.size.y/2-(e.pos.y+e.size.y/2),h=new r.Vector2(s,i),o=new r.Vector2(t.size.x/2+e.size.x/2,t.size.y/2+e.size.y/2);let a=null;if(Math.abs(h.x)<o.x&&Math.abs(h.y)<o.y){const e=o.x-Math.abs(h.x),s=o.y-Math.abs(h.y);if(e>=s)return t instanceof n.default&&t.falling&&(t.grounded=!0,t.falling=!1),a=h.y>0?"b":"t",h.y>0?t.pos.y+=s:t.pos.y-=s,a;a=h.x>0?"r":"l",h.x>0?t.pos.x+=e:t.pos.x-=e}return a}static intersects(t,e){return t.pos.x<e.pos.x+e.size.x&&t.pos.x+t.size.x>e.pos.x&&(t instanceof n.default?t.pos.y+.25:t.pos.y)<e.pos.y+e.size.y&&(t instanceof n.default?t.pos.y+.25:t.pos.y)+t.size.y>e.pos.y}}},291:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(648),n=i(s(111)),h=i(s(319)),o=i(s(314)),a=i(s(821));class c extends a.default{constructor(t){super(t),this.playerDead=!1,this.player=null,this.timer=new o.default,this.deathTimeout=1,this.level=new h.default(t)}init(){this.level.init(),this.player=this.summonPlayer(),this.level.add(this.player)}tick(){const t=this.level.getPlayer();t.alive||(this.deathTimeout-=.03,this.deathTimeout<=0&&(this.level.refresh(),t.pos=this.level.chunksData[this.level.currentChunk].spawnPoint.clone(),t.alive=!0,t.health=25,this.deathTimeout=1)),t.alive&&t.tick()}render(){this.level.render(),this.timer.render(this.context,25===this.level.currentChunk)}summonPlayer(){const t=new r.Vector2,e=this.level.chunksData[this.level.currentChunk].spawnPoint.clone();return new n.default(this.level,t,e)}}e.default=c,c.SCALE=32},821:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t){this.context=t}}}},e={};function s(i){var r=e[i];if(void 0!==r)return r.exports;var n=e[i]={exports:{}};return t[i].call(n.exports,n,n.exports,s),n.exports}s.d=(t,e)=>{for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),s.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s(862)})();