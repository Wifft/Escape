(()=>{"use strict";var t={648:(t,e,s)=>{function i(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}s.r(e),s.d(e,{Euler:()=>It,Matrix3:()=>ct,Matrix4:()=>yt,Pose:()=>Tt,Quaternion:()=>_t,SphericalCoordinates:()=>Lt,Vector2:()=>Z,Vector3:()=>J,Vector4:()=>et,_Euler:()=>It,_MathUtils:()=>Pt,_Pose:()=>Tt,_SphericalCoordinates:()=>Lt,acos:()=>x,asin:()=>w,assert:()=>i,atan:()=>E,checkNumber:()=>P,clamp:()=>b,clone:()=>u,config:()=>h,configure:()=>a,cos:()=>m,degrees:()=>g,equals:()=>S,exactEquals:()=>k,formatValue:()=>o,isArray:()=>c,lerp:()=>v,radians:()=>p,sin:()=>y,tan:()=>M,toDegrees:()=>d,toRadians:()=>f,withEpsilon:()=>O});const r=1/Math.PI*180,n=1/180*Math.PI,h={};function a(t={}){for(const e in t)i(e in h),h[e]=t[e];return h}function o(t,{precision:e=h.precision||4}={}){return t=function(t){return Math.round(t/h.EPSILON)*h.EPSILON}(t),"".concat(parseFloat(t.toPrecision(e)))}function c(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function u(t){return t.clone?t.clone():new Array(...t)}function l(t,e,s){if(c(t)){s=s||((i=t).clone?i.clone():new Array(i.length));for(let i=0;i<s.length&&i<t.length;++i)s[i]=e(t[i],i,s);return s}var i;return e(t)}function f(t){return p(t)}function d(t){return g(t)}function p(t,e){return l(t,(t=>t*n),e)}function g(t,e){return l(t,(t=>t*r),e)}function y(t){return l(t,(t=>Math.sin(t)))}function m(t){return l(t,(t=>Math.cos(t)))}function M(t){return l(t,(t=>Math.tan(t)))}function w(t){return l(t,(t=>Math.asin(t)))}function x(t){return l(t,(t=>Math.acos(t)))}function E(t){return l(t,(t=>Math.atan(t)))}function b(t,e,s){return l(t,(t=>Math.max(e,Math.min(s,t))))}function v(t,e,s){return c(t)?t.map(((t,i)=>v(t,e[i],s))):s*e+(1-s)*t}function S(t,e,s){const i=h.EPSILON;s&&(h.EPSILON=s);try{if(t===e)return!0;if(c(t)&&c(e)){if(t.length!==e.length)return!1;for(let s=0;s<t.length;++s)if(!S(t[s],e[s]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):!(!Number.isFinite(t)||!Number.isFinite(e))&&Math.abs(t-e)<=h.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}finally{h.EPSILON=i}}function k(t,e){if(t===e)return!0;if(t&&"object"==typeof t&&e&&"object"==typeof e){if(t.constructor!==e.constructor)return!1;if(t.exactEquals)return t.exactEquals(e)}if(c(t)&&c(e)){if(t.length!==e.length)return!1;for(let s=0;s<t.length;++s)if(!k(t[s],e[s]))return!1;return!0}return!1}function O(t,e){const s=h.EPSILON;let i;h.EPSILON=t;try{i=e()}finally{h.EPSILON=s}return i}h.EPSILON=1e-12,h.debug=!1,h.precision=4,h.printTypes=!1,h.printDegrees=!1,h.printRowMajor=!0;class _ extends(function(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}(Array)){get ELEMENTS(){return i(!1),0}clone(){return(new this.constructor).copy(this)}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}fromArray(t,e=0){for(let s=0;s<this.ELEMENTS;++s)this[s]=t[s+e];return this.check()}to(t){return t===this?this:c(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toArray(t=[],e=0){for(let s=0;s<this.ELEMENTS;++s)t[e+s]=this[s];return t}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(h)}formatString(t){let e="";for(let s=0;s<this.ELEMENTS;++s)e+=(s>0?", ":"")+o(this[s],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(e,"]")}equals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(!S(this[e],t[e]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,e,s){void 0===s&&(s=e,e=t,t=this);for(let i=0;i<this.ELEMENTS;++i){const r=t[i];this[i]=r+s*(e[i]-r)}return this.check()}min(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}max(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}clamp(t,e){for(let s=0;s<this.ELEMENTS;++s)this[s]=Math.min(Math.max(this[s],t[s]),e[s]);return this.check()}add(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]+=e[t];return this.check()}subtract(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]-=e[t];return this.check()}scale(t){if(Array.isArray(t))return this.multiply(t);for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}sub(t){return this.subtract(t)}setScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}addScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}divideScalar(t){return this.scale(1/t)}clampScalar(t,e){for(let s=0;s<this.ELEMENTS;++s)this[s]=Math.min(Math.max(this[s],t),e);return this.check()}multiplyByScalar(t){return this.scale(t)}get elements(){return this}check(){if(h.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let t=this.length===this.ELEMENTS;for(let e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}}function P(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function A(t,e,s=""){if(h.debug&&!function(t,e){if(t.length!==e)return!1;for(let e=0;e<t.length;++e)if(!Number.isFinite(t[e]))return!1;return!0}(t,e))throw new Error("math.gl: ".concat(s," some fields set to invalid numbers'"));return t}const L={};function R(t,e){L[t]||(L[t]=!0,console.warn("".concat(t," has been removed in version ").concat(e,", see upgrade guide for more information")))}class N extends _{get ELEMENTS(){return i(!1),0}copy(t){return i(!1),this}get x(){return this[0]}set x(t){this[0]=P(t)}get y(){return this[1]}set y(t){this[1]=P(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let e=0;for(let s=0;s<this.ELEMENTS;++s){const i=this[s]-t[s];e+=i*i}return P(e)}dot(t){let e=0;for(let s=0;s<this.ELEMENTS;++s)e+=this[s]*t[s];return P(e)}normalize(){const t=this.magnitude();if(0!==t)for(let e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}multiply(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]*=e[t];return this.check()}divide(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e[t];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return i(t>=0&&t<this.ELEMENTS,"index is out of range"),P(this[t])}setComponent(t,e){return i(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}addVectors(t,e){return this.copy(t).add(e)}subVectors(t,e){return this.copy(t).subtract(e)}multiplyVectors(t,e){return this.copy(t).multiply(e)}addScaledVector(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}}var I,T=1e-6,C="undefined"!=typeof Float32Array?Float32Array:Array;function V(t,e,s){var i=e[0],r=e[1];return t[0]=s[0]*i+s[3]*r+s[6],t[1]=s[1]*i+s[4]*r+s[7],t}function j(t,e,s){var i=e[0],r=e[1];return t[0]=s[0]*i+s[4]*r+s[12],t[1]=s[1]*i+s[5]*r+s[13],t}function z(t,e,s){const i=e[0],r=e[1],n=s[3]*i+s[7]*r||1;return t[0]=(s[0]*i+s[4]*r)/n,t[1]=(s[1]*i+s[5]*r)/n,t}function D(t,e,s){const i=e[0],r=e[1],n=e[2],h=s[3]*i+s[7]*r+s[11]*n||1;return t[0]=(s[0]*i+s[4]*r+s[8]*n)/h,t[1]=(s[1]*i+s[5]*r+s[9]*n)/h,t[2]=(s[2]*i+s[6]*r+s[10]*n)/h,t}function F(t,e,s){const i=e[0],r=e[1],n=e[2];return t[0]=s[0]*i+s[3]*r+s[6]*n,t[1]=s[1]*i+s[4]*r+s[7]*n,t[2]=s[2]*i+s[5]*r+s[8]*n,t[3]=e[3],t}Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)}),I=new C(2),C!=Float32Array&&(I[0]=0,I[1]=0);class Z extends N{constructor(t=0,e=0){super(2),c(t)&&1===arguments.length?this.copy(t):(h.debug&&(P(t),P(e)),this[0]=t,this[1]=e)}set(t,e){return this[0]=t,this[1]=e,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this.check()}fromObject(t){return h.debug&&(P(t.x),P(t.y)),this[0]=t.x,this[1]=t.y,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t}get ELEMENTS(){return 2}horizontalAngle(){return Math.atan2(this.y,this.x)}verticalAngle(){return Math.atan2(this.x,this.y)}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return j(this,this,t),this.check()}transformAsVector(t){return z(this,this,t),this.check()}transformByMatrix3(t){return V(this,this,t),this.check()}transformByMatrix2x3(t){return function(t,e,s){var i=e[0],r=e[1];t[0]=s[0]*i+s[2]*r+s[4],t[1]=s[1]*i+s[3]*r+s[5]}(this,this,t),this.check()}transformByMatrix2(t){return function(t,e,s){var i=e[0],r=e[1];t[0]=s[0]*i+s[2]*r,t[1]=s[1]*i+s[3]*r}(this,this,t),this.check()}}function Y(){var t=new C(3);return C!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function X(t){var e=t[0],s=t[1],i=t[2];return Math.hypot(e,s,i)}function q(t,e,s){var i=new C(3);return i[0]=t,i[1]=e,i[2]=s,i}function K(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function W(t,e,s){var i=e[0],r=e[1],n=e[2],h=s[0],a=s[1],o=s[2];return t[0]=r*o-n*a,t[1]=n*h-i*o,t[2]=i*a-r*h,t}function B(t,e,s){var i=e[0],r=e[1],n=e[2],h=s[3]*i+s[7]*r+s[11]*n+s[15];return h=h||1,t[0]=(s[0]*i+s[4]*r+s[8]*n+s[12])/h,t[1]=(s[1]*i+s[5]*r+s[9]*n+s[13])/h,t[2]=(s[2]*i+s[6]*r+s[10]*n+s[14])/h,t}function Q(t,e,s){var i=e[0],r=e[1],n=e[2];return t[0]=i*s[0]+r*s[3]+n*s[6],t[1]=i*s[1]+r*s[4]+n*s[7],t[2]=i*s[2]+r*s[5]+n*s[8],t}function H(t,e,s){var i=s[0],r=s[1],n=s[2],h=s[3],a=e[0],o=e[1],c=e[2],u=r*c-n*o,l=n*a-i*c,f=i*o-r*a,d=r*f-n*l,p=n*u-i*f,g=i*l-r*u,y=2*h;return u*=y,l*=y,f*=y,d*=2,p*=2,g*=2,t[0]=a+u+d,t[1]=o+l+p,t[2]=c+f+g,t}var U=X;Y();const $=[0,0,0],G={};class J extends N{static get ZERO(){return G.ZERO=G.ZERO||Object.freeze(new J(0,0,0,0))}constructor(t=0,e=0,s=0){super(-0,-0,-0),1===arguments.length&&c(t)?this.copy(t):(h.debug&&(P(t),P(e),P(s)),this[0]=t,this[1]=e,this[2]=s)}set(t,e,s){return this[0]=t,this[1]=e,this[2]=s,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return h.debug&&(P(t.x),P(t.y),P(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=P(t)}angle(t){return s=t,i=(e=this)[0],r=e[1],n=e[2],h=s[0],a=s[1],o=s[2],u=(c=Math.sqrt(i*i+r*r+n*n)*Math.sqrt(h*h+a*a+o*o))&&K(e,s)/c,Math.acos(Math.min(Math.max(u,-1),1));var e,s,i,r,n,h,a,o,c,u}cross(t){return W(this,this,t),this.check()}rotateX({radians:t,origin:e=$}){return function(t,e,s,i){var r=[],n=[];r[0]=e[0]-s[0],r[1]=e[1]-s[1],r[2]=e[2]-s[2],n[0]=r[0],n[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),n[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),t[0]=n[0]+s[0],t[1]=n[1]+s[1],t[2]=n[2]+s[2]}(this,this,e,t),this.check()}rotateY({radians:t,origin:e=$}){return function(t,e,s,i){var r=[],n=[];r[0]=e[0]-s[0],r[1]=e[1]-s[1],r[2]=e[2]-s[2],n[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),n[1]=r[1],n[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),t[0]=n[0]+s[0],t[1]=n[1]+s[1],t[2]=n[2]+s[2]}(this,this,e,t),this.check()}rotateZ({radians:t,origin:e=$}){return function(t,e,s,i){var r=[],n=[];r[0]=e[0]-s[0],r[1]=e[1]-s[1],r[2]=e[2]-s[2],n[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),n[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),n[2]=r[2],t[0]=n[0]+s[0],t[1]=n[1]+s[1],t[2]=n[2]+s[2]}(this,this,e,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return B(this,this,t),this.check()}transformAsVector(t){return D(this,this,t),this.check()}transformByMatrix3(t){return Q(this,this,t),this.check()}transformByMatrix2(t){return function(t,e,s){const i=e[0],r=e[1];t[0]=s[0]*i+s[2]*r,t[1]=s[1]*i+s[3]*r,t[2]=e[2]}(this,this,t),this.check()}transformByQuaternion(t){return H(this,this,t),this.check()}}const tt={};class et extends N{static get ZERO(){return tt.ZERO=tt.ZERO||Object.freeze(new et(0,0,0,0))}constructor(t=0,e=0,s=0,i=0){super(-0,-0,-0,-0),c(t)&&1===arguments.length?this.copy(t):(h.debug&&(P(t),P(e),P(s),P(i)),this[0]=t,this[1]=e,this[2]=s,this[3]=i)}set(t,e,s,i){return this[0]=t,this[1]=e,this[2]=s,this[3]=i,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}fromObject(t){return h.debug&&(P(t.x),P(t.y),P(t.z),P(t.w)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t.w=this[3],t}get ELEMENTS(){return 4}get z(){return this[2]}set z(t){this[2]=P(t)}get w(){return this[3]}set w(t){this[3]=P(t)}transform(t){return B(this,this,t),this.check()}transformByMatrix3(t){return F(this,this,t),this.check()}transformByMatrix2(t){return function(t,e,s){const i=e[0],r=e[1];t[0]=s[0]*i+s[2]*r,t[1]=s[1]*i+s[3]*r,t[2]=e[2],t[3]=e[3]}(this,this,t),this.check()}transformByQuaternion(t){return H(this,this,t),this.check()}applyMatrix4(t){return t.transform(this,this),this}}class st extends _{get ELEMENTS(){return i(!1),0}get RANK(){return i(!1),0}toString(){let t="[";if(h.printRowMajor){t+="row-major:";for(let e=0;e<this.RANK;++e)for(let s=0;s<this.RANK;++s)t+=" ".concat(this[s*this.RANK+e])}else{t+="column-major:";for(let e=0;e<this.ELEMENTS;++e)t+=" ".concat(this[e])}return t+="]",t}getElementIndex(t,e){return e*this.RANK+t}getElement(t,e){return this[e*this.RANK+t]}setElement(t,e,s){return this[e*this.RANK+t]=P(s),this}getColumn(t,e=new Array(this.RANK).fill(-0)){const s=t*this.RANK;for(let t=0;t<this.RANK;++t)e[t]=this[s+t];return e}setColumn(t,e){const s=t*this.RANK;for(let t=0;t<this.RANK;++t)this[s+t]=e[t];return this}}function it(t,e,s){var i=e[0],r=e[1],n=e[2],h=e[3],a=e[4],o=e[5],c=e[6],u=e[7],l=e[8],f=s[0],d=s[1],p=s[2],g=s[3],y=s[4],m=s[5],M=s[6],w=s[7],x=s[8];return t[0]=f*i+d*h+p*c,t[1]=f*r+d*a+p*u,t[2]=f*n+d*o+p*l,t[3]=g*i+y*h+m*c,t[4]=g*r+y*a+m*u,t[5]=g*n+y*o+m*l,t[6]=M*i+w*h+x*c,t[7]=M*r+w*a+x*u,t[8]=M*n+w*o+x*l,t}function rt(t,e,s){var i=s[0],r=s[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}const nt=Object.freeze([1,0,0,0,1,0,0,0,1]),ht=Object.freeze([0,0,0,0,0,0,0,0,0]),at=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL1ROW0:3,COL1ROW1:4,COL1ROW2:5,COL2ROW0:6,COL2ROW1:7,COL2ROW2:8}),ot={};class ct extends st{static get IDENTITY(){return ot.IDENTITY=ot.IDENTITY||Object.freeze(new ct(nt)),ot.IDENTITY}static get ZERO(){return ot.ZERO=ot.ZERO||Object.freeze(new ct(ht)),ot.ZERO}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return at}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}set(t,e,s,i,r,n,h,a,o){return this[0]=t,this[1]=e,this[2]=s,this[3]=i,this[4]=r,this[5]=n,this[6]=h,this[7]=a,this[8]=o,this.check()}setRowMajor(t,e,s,i,r,n,h,a,o){return this[0]=t,this[1]=i,this[2]=h,this[3]=e,this[4]=r,this[5]=a,this[6]=s,this[7]=n,this[8]=o,this.check()}determinant(){return e=(t=this)[0],s=t[1],i=t[2],r=t[3],n=t[4],h=t[5],a=t[6],o=t[7],e*((c=t[8])*n-h*o)+s*(-c*r+h*a)+i*(o*r-n*a);var t,e,s,i,r,n,h,a,o,c}identity(){return this.copy(nt)}fromQuaternion(t){return function(t,e){var s=e[0],i=e[1],r=e[2],n=e[3],h=s+s,a=i+i,o=r+r,c=s*h,u=i*h,l=i*a,f=r*h,d=r*a,p=r*o,g=n*h,y=n*a,m=n*o;t[0]=1-l-p,t[3]=u-m,t[6]=f+y,t[1]=u+m,t[4]=1-c-p,t[7]=d-g,t[2]=f-y,t[5]=d+g,t[8]=1-c-l}(this,t),this.check()}transpose(){return function(t,e){if(t===e){var s=e[1],i=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=s,t[5]=e[7],t[6]=i,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8]}(this,this),this.check()}invert(){return function(t,e){var s=e[0],i=e[1],r=e[2],n=e[3],h=e[4],a=e[5],o=e[6],c=e[7],u=e[8],l=u*h-a*c,f=-u*n+a*o,d=c*n-h*o,p=s*l+i*f+r*d;p&&(p=1/p,t[0]=l*p,t[1]=(-u*i+r*c)*p,t[2]=(a*i-r*h)*p,t[3]=f*p,t[4]=(u*s-r*o)*p,t[5]=(-a*s+r*n)*p,t[6]=d*p,t[7]=(-c*s+i*o)*p,t[8]=(h*s-i*n)*p)}(this,this),this.check()}multiplyLeft(t){return it(this,t,this),this.check()}multiplyRight(t){return it(this,this,t),this.check()}rotate(t){return function(t,e,s){var i=e[0],r=e[1],n=e[2],h=e[3],a=e[4],o=e[5],c=e[6],u=e[7],l=e[8],f=Math.sin(s),d=Math.cos(s);t[0]=d*i+f*h,t[1]=d*r+f*a,t[2]=d*n+f*o,t[3]=d*h-f*i,t[4]=d*a-f*r,t[5]=d*o-f*n,t[6]=c,t[7]=u,t[8]=l}(this,this,t),this.check()}scale(t){return Array.isArray(t)?rt(this,this,t):rt(this,this,[t,t,t]),this.check()}translate(t){return function(t,e,s){var i=e[0],r=e[1],n=e[2],h=e[3],a=e[4],o=e[5],c=e[6],u=e[7],l=e[8],f=s[0],d=s[1];t[0]=i,t[1]=r,t[2]=n,t[3]=h,t[4]=a,t[5]=o,t[6]=f*i+d*h+c,t[7]=f*r+d*a+u,t[8]=f*n+d*o+l}(this,this,t),this.check()}transform(t,e){switch(t.length){case 2:e=V(e||[-0,-0],t,this);break;case 3:e=Q(e||[-0,-0,-0],t,this);break;case 4:e=F(e||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return A(e,t.length),e}transformVector(t,e){return R("Matrix3.transformVector"),this.transform(t,e)}transformVector2(t,e){return R("Matrix3.transformVector"),this.transform(t,e)}transformVector3(t,e){return R("Matrix3.transformVector"),this.transform(t,e)}}function ut(t,e,s){var i=e[0],r=e[1],n=e[2],h=e[3],a=e[4],o=e[5],c=e[6],u=e[7],l=e[8],f=e[9],d=e[10],p=e[11],g=e[12],y=e[13],m=e[14],M=e[15],w=s[0],x=s[1],E=s[2],b=s[3];return t[0]=w*i+x*a+E*l+b*g,t[1]=w*r+x*o+E*f+b*y,t[2]=w*n+x*c+E*d+b*m,t[3]=w*h+x*u+E*p+b*M,w=s[4],x=s[5],E=s[6],b=s[7],t[4]=w*i+x*a+E*l+b*g,t[5]=w*r+x*o+E*f+b*y,t[6]=w*n+x*c+E*d+b*m,t[7]=w*h+x*u+E*p+b*M,w=s[8],x=s[9],E=s[10],b=s[11],t[8]=w*i+x*a+E*l+b*g,t[9]=w*r+x*o+E*f+b*y,t[10]=w*n+x*c+E*d+b*m,t[11]=w*h+x*u+E*p+b*M,w=s[12],x=s[13],E=s[14],b=s[15],t[12]=w*i+x*a+E*l+b*g,t[13]=w*r+x*o+E*f+b*y,t[14]=w*n+x*c+E*d+b*m,t[15]=w*h+x*u+E*p+b*M,t}function lt(t,e,s){var i=s[0],r=s[1],n=s[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}!function(){var t=new C(4);C!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0)}();const ft=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),dt=Object.freeze([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),pt=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL0ROW3:3,COL1ROW0:4,COL1ROW1:5,COL1ROW2:6,COL1ROW3:7,COL2ROW0:8,COL2ROW1:9,COL2ROW2:10,COL2ROW3:11,COL3ROW0:12,COL3ROW1:13,COL3ROW2:14,COL3ROW3:15}),gt={};class yt extends st{static get IDENTITY(){return gt.IDENTITY=gt.IDENTITY||Object.freeze(new yt(ft)),gt.IDENTITY}static get ZERO(){return gt.ZERO=gt.ZERO||Object.freeze(new yt(dt)),gt.ZERO}get INDICES(){return pt}get ELEMENTS(){return 16}get RANK(){return 4}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,e,s,i,r,n,h,a,o,c,u,l,f,d,p,g){return this[0]=t,this[1]=e,this[2]=s,this[3]=i,this[4]=r,this[5]=n,this[6]=h,this[7]=a,this[8]=o,this[9]=c,this[10]=u,this[11]=l,this[12]=f,this[13]=d,this[14]=p,this[15]=g,this.check()}setRowMajor(t,e,s,i,r,n,h,a,o,c,u,l,f,d,p,g){return this[0]=t,this[1]=r,this[2]=o,this[3]=f,this[4]=e,this[5]=n,this[6]=c,this[7]=d,this[8]=s,this[9]=h,this[10]=u,this[11]=p,this[12]=i,this[13]=a,this[14]=l,this[15]=g,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(ft)}fromQuaternion(t){return function(t,e){var s=e[0],i=e[1],r=e[2],n=e[3],h=s+s,a=i+i,o=r+r,c=s*h,u=i*h,l=i*a,f=r*h,d=r*a,p=r*o,g=n*h,y=n*a,m=n*o;t[0]=1-l-p,t[1]=u+m,t[2]=f-y,t[3]=0,t[4]=u-m,t[5]=1-c-p,t[6]=d+g,t[7]=0,t[8]=f+y,t[9]=d-g,t[10]=1-c-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(this,t),this.check()}frustum({left:t,right:e,bottom:s,top:i,near:r,far:n}){return n===1/0?yt._computeInfinitePerspectiveOffCenter(this,t,e,s,i,r):function(t,e,s,i,r,n,h){var a=1/(s-e),o=1/(r-i),c=1/(n-h);t[0]=2*n*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*n*o,t[6]=0,t[7]=0,t[8]=(s+e)*a,t[9]=(r+i)*o,t[10]=(h+n)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=h*n*2*c,t[15]=0}(this,t,e,s,i,r,n),this.check()}static _computeInfinitePerspectiveOffCenter(t,e,s,i,r,n){const h=2*n/(s-e),a=2*n/(r-i),o=(s+e)/(s-e),c=(r+i)/(r-i),u=-2*n;return t[0]=h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=o,t[9]=c,t[10]=-1,t[11]=-1,t[12]=0,t[13]=0,t[14]=u,t[15]=0,t}lookAt(t,e,s){return 1===arguments.length&&({eye:t,center:e,up:s}=t),function(t,e,s,i){var r,n,h,a,o,c,u,l,f,d,p=e[0],g=e[1],y=e[2],m=i[0],M=i[1],w=i[2],x=s[0],E=s[1],b=s[2];Math.abs(p-x)<T&&Math.abs(g-E)<T&&Math.abs(y-b)<T?function(t){t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(t):(u=p-x,l=g-E,f=y-b,r=M*(f*=d=1/Math.hypot(u,l,f))-w*(l*=d),n=w*(u*=d)-m*f,h=m*l-M*u,(d=Math.hypot(r,n,h))?(r*=d=1/d,n*=d,h*=d):(r=0,n=0,h=0),a=l*h-f*n,o=f*r-u*h,c=u*n-l*r,(d=Math.hypot(a,o,c))?(a*=d=1/d,o*=d,c*=d):(a=0,o=0,c=0),t[0]=r,t[1]=a,t[2]=u,t[3]=0,t[4]=n,t[5]=o,t[6]=l,t[7]=0,t[8]=h,t[9]=c,t[10]=f,t[11]=0,t[12]=-(r*p+n*g+h*y),t[13]=-(a*p+o*g+c*y),t[14]=-(u*p+l*g+f*y),t[15]=1)}(this,t,e=e||[0,0,0],s=s||[0,1,0]),this.check()}ortho({left:t,right:e,bottom:s,top:i,near:r=.1,far:n=500}){return function(t,e,s,i,r,n,h){var a=1/(e-s),o=1/(i-r),c=1/(n-h);t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+s)*a,t[13]=(r+i)*o,t[14]=(h+n)*c,t[15]=1}(this,t,e,s,i,r,n),this.check()}orthographic({fovy:t=45*Math.PI/180,aspect:e=1,focalDistance:s=1,near:i=.1,far:r=500}){if(t>2*Math.PI)throw Error("radians");const n=t/2,h=s*Math.tan(n),a=h*e;return(new yt).ortho({left:-a,right:a,bottom:-h,top:h,near:i,far:r})}perspective({fovy:t,fov:e=45*Math.PI/180,aspect:s=1,near:i=.1,far:r=500}={}){if((t=t||e)>2*Math.PI)throw Error("radians");return function(t,e,s,i,r){var n,h=1/Math.tan(e/2);t[0]=h/s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(n=1/(i-r),t[10]=(r+i)*n,t[14]=2*r*i*n):(t[10]=-1,t[14]=-2*i)}(this,t,s,i,r),this.check()}determinant(){return e=(t=this)[0],s=t[1],i=t[2],r=t[3],n=t[4],h=t[5],a=t[6],o=t[7],c=t[8],u=t[9],l=t[10],f=t[11],d=t[12],p=t[13],g=t[14],(e*h-s*n)*(l*(y=t[15])-f*g)-(e*a-i*n)*(u*y-f*p)+(e*o-r*n)*(u*g-l*p)+(s*a-i*h)*(c*y-f*d)-(s*o-r*h)*(c*g-l*d)+(i*o-r*a)*(c*p-u*d);var t,e,s,i,r,n,h,a,o,c,u,l,f,d,p,g,y}getScale(t=[-0,-0,-0]){return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(t=[-0,-0,-0]){return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t=[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],e=null){const s=this.getScale(e||[-0,-0,-0]),i=1/s[0],r=1/s[1],n=1/s[2];return t[0]=this[0]*i,t[1]=this[1]*r,t[2]=this[2]*n,t[3]=0,t[4]=this[4]*i,t[5]=this[5]*r,t[6]=this[6]*n,t[7]=0,t[8]=this[8]*i,t[9]=this[9]*r,t[10]=this[10]*n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t=[-0,-0,-0,-0,-0,-0,-0,-0,-0],e=null){const s=this.getScale(e||[-0,-0,-0]),i=1/s[0],r=1/s[1],n=1/s[2];return t[0]=this[0]*i,t[1]=this[1]*r,t[2]=this[2]*n,t[3]=this[4]*i,t[4]=this[5]*r,t[5]=this[6]*n,t[6]=this[8]*i,t[7]=this[9]*r,t[8]=this[10]*n,t}transpose(){return function(t,e){if(t===e){var s=e[1],i=e[2],r=e[3],n=e[6],h=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=s,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=n,t[11]=e[14],t[12]=r,t[13]=h,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15]}(this,this),this.check()}invert(){return function(t,e){var s=e[0],i=e[1],r=e[2],n=e[3],h=e[4],a=e[5],o=e[6],c=e[7],u=e[8],l=e[9],f=e[10],d=e[11],p=e[12],g=e[13],y=e[14],m=e[15],M=s*a-i*h,w=s*o-r*h,x=s*c-n*h,E=i*o-r*a,b=i*c-n*a,v=r*c-n*o,S=u*g-l*p,k=u*y-f*p,O=u*m-d*p,_=l*y-f*g,P=l*m-d*g,A=f*m-d*y,L=M*A-w*P+x*_+E*O-b*k+v*S;L&&(L=1/L,t[0]=(a*A-o*P+c*_)*L,t[1]=(r*P-i*A-n*_)*L,t[2]=(g*v-y*b+m*E)*L,t[3]=(f*b-l*v-d*E)*L,t[4]=(o*O-h*A-c*k)*L,t[5]=(s*A-r*O+n*k)*L,t[6]=(y*x-p*v-m*w)*L,t[7]=(u*v-f*x+d*w)*L,t[8]=(h*P-a*O+c*S)*L,t[9]=(i*O-s*P-n*S)*L,t[10]=(p*b-g*x+m*M)*L,t[11]=(l*x-u*b-d*M)*L,t[12]=(a*k-h*_-o*S)*L,t[13]=(s*_-i*k+r*S)*L,t[14]=(g*w-p*E-y*M)*L,t[15]=(u*E-l*w+f*M)*L)}(this,this),this.check()}multiplyLeft(t){return ut(this,t,this),this.check()}multiplyRight(t){return ut(this,this,t),this.check()}rotateX(t){return function(t,e,s){var i=Math.sin(s),r=Math.cos(s),n=e[4],h=e[5],a=e[6],o=e[7],c=e[8],u=e[9],l=e[10],f=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=n*r+c*i,t[5]=h*r+u*i,t[6]=a*r+l*i,t[7]=o*r+f*i,t[8]=c*r-n*i,t[9]=u*r-h*i,t[10]=l*r-a*i,t[11]=f*r-o*i}(this,this,t),this.check()}rotateY(t){return function(t,e,s){var i=Math.sin(s),r=Math.cos(s),n=e[0],h=e[1],a=e[2],o=e[3],c=e[8],u=e[9],l=e[10],f=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=n*r-c*i,t[1]=h*r-u*i,t[2]=a*r-l*i,t[3]=o*r-f*i,t[8]=n*i+c*r,t[9]=h*i+u*r,t[10]=a*i+l*r,t[11]=o*i+f*r}(this,this,t),this.check()}rotateZ(t){return function(t,e,s){var i=Math.sin(s),r=Math.cos(s),n=e[0],h=e[1],a=e[2],o=e[3],c=e[4],u=e[5],l=e[6],f=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=n*r+c*i,t[1]=h*r+u*i,t[2]=a*r+l*i,t[3]=o*r+f*i,t[4]=c*r-n*i,t[5]=u*r-h*i,t[6]=l*r-a*i,t[7]=f*r-o*i}(this,this,t),this.check()}rotateXYZ([t,e,s]){return this.rotateX(t).rotateY(e).rotateZ(s)}rotateAxis(t,e){return function(t,e,s,i){var r,n,h,a,o,c,u,l,f,d,p,g,y,m,M,w,x,E,b,v,S,k,O,_,P=i[0],A=i[1],L=i[2],R=Math.hypot(P,A,L);R<T||(P*=R=1/R,A*=R,L*=R,r=Math.sin(s),h=1-(n=Math.cos(s)),a=e[0],o=e[1],c=e[2],u=e[3],l=e[4],f=e[5],d=e[6],p=e[7],g=e[8],y=e[9],m=e[10],M=e[11],w=P*P*h+n,x=A*P*h+L*r,E=L*P*h-A*r,b=P*A*h-L*r,v=A*A*h+n,S=L*A*h+P*r,k=P*L*h+A*r,O=A*L*h-P*r,_=L*L*h+n,t[0]=a*w+l*x+g*E,t[1]=o*w+f*x+y*E,t[2]=c*w+d*x+m*E,t[3]=u*w+p*x+M*E,t[4]=a*b+l*v+g*S,t[5]=o*b+f*v+y*S,t[6]=c*b+d*v+m*S,t[7]=u*b+p*v+M*S,t[8]=a*k+l*O+g*_,t[9]=o*k+f*O+y*_,t[10]=c*k+d*O+m*_,t[11]=u*k+p*O+M*_,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]))}(this,this,t,e),this.check()}scale(t){return Array.isArray(t)?lt(this,this,t):lt(this,this,[t,t,t]),this.check()}translate(t){return function(t,e,s){var i,r,n,h,a,o,c,u,l,f,d,p,g=s[0],y=s[1],m=s[2];e===t?(t[12]=e[0]*g+e[4]*y+e[8]*m+e[12],t[13]=e[1]*g+e[5]*y+e[9]*m+e[13],t[14]=e[2]*g+e[6]*y+e[10]*m+e[14],t[15]=e[3]*g+e[7]*y+e[11]*m+e[15]):(i=e[0],r=e[1],n=e[2],h=e[3],a=e[4],o=e[5],c=e[6],u=e[7],l=e[8],f=e[9],d=e[10],p=e[11],t[0]=i,t[1]=r,t[2]=n,t[3]=h,t[4]=a,t[5]=o,t[6]=c,t[7]=u,t[8]=l,t[9]=f,t[10]=d,t[11]=p,t[12]=i*g+a*y+l*m+e[12],t[13]=r*g+o*y+f*m+e[13],t[14]=n*g+c*y+d*m+e[14],t[15]=h*g+u*y+p*m+e[15])}(this,this,t),this.check()}transform(t,e){return 4===t.length?(e=function(t,e,s){var i=e[0],r=e[1],n=e[2],h=e[3];return t[0]=s[0]*i+s[4]*r+s[8]*n+s[12]*h,t[1]=s[1]*i+s[5]*r+s[9]*n+s[13]*h,t[2]=s[2]*i+s[6]*r+s[10]*n+s[14]*h,t[3]=s[3]*i+s[7]*r+s[11]*n+s[15]*h,t}(e||[-0,-0,-0,-0],t,this),A(e,4),e):this.transformAsPoint(t,e)}transformAsPoint(t,e){const{length:s}=t;switch(s){case 2:e=j(e||[-0,-0],t,this);break;case 3:e=B(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return A(e,t.length),e}transformAsVector(t,e){switch(t.length){case 2:e=z(e||[-0,-0],t,this);break;case 3:e=D(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return A(e,t.length),e}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,e,s){return this.identity().translate([t,e,s])}transformPoint(t,e){return R("Matrix4.transformPoint","3.0"),this.transformAsPoint(t,e)}transformVector(t,e){return R("Matrix4.transformVector","3.0"),this.transformAsPoint(t,e)}transformDirection(t,e){return R("Matrix4.transformDirection","3.0"),this.transformAsVector(t,e)}}function mt(){var t=new C(4);return C!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Mt(t,e,s){s*=.5;var i=Math.sin(s);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(s),t}function wt(t,e,s){var i=e[0],r=e[1],n=e[2],h=e[3],a=s[0],o=s[1],c=s[2],u=s[3];return t[0]=i*u+h*a+r*c-n*o,t[1]=r*u+h*o+n*a-i*c,t[2]=n*u+h*c+i*o-r*a,t[3]=h*u-i*a-r*o-n*c,t}var xt,Et,bt,vt=function(t){var e=t[0],s=t[1],i=t[2],r=t[3];return Math.hypot(e,s,i,r)},St=function(t){var e=t[0],s=t[1],i=t[2],r=t[3];return e*e+s*s+i*i+r*r},kt=(xt=Y(),Et=q(1,0,0),bt=q(0,1,0),function(t,e,s){var i=K(e,s);return i<-.999999?(W(xt,Et,e),U(xt)<1e-6&&W(xt,bt,e),function(t,e){var s=e[0],i=e[1],r=e[2],n=s*s+i*i+r*r;n>0&&(n=1/Math.sqrt(n)),t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n}(xt,xt),Mt(t,xt,Math.PI),t):i>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(W(xt,e,s),t[0]=xt[0],t[1]=xt[1],t[2]=xt[2],t[3]=1+i,function(t,e){var s=e[0],i=e[1],r=e[2],n=e[3],h=s*s+i*i+r*r+n*n;return h>0&&(h=1/Math.sqrt(h)),t[0]=s*h,t[1]=i*h,t[2]=r*h,t[3]=n*h,t}(t,t))});mt(),mt(),function(){var t=new C(9);C!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1}();const Ot=[0,0,0,1];class _t extends _{constructor(t=0,e=0,s=0,i=1){super(-0,-0,-0,-0),Array.isArray(t)&&1===arguments.length?this.copy(t):this.set(t,e,s,i)}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}set(t,e,s,i){return this[0]=t,this[1]=e,this[2]=s,this[3]=i,this.check()}fromMatrix3(t){return function(t,e){var s,i=e[0]+e[4]+e[8];if(i>0)s=Math.sqrt(i+1),t[3]=.5*s,s=.5/s,t[0]=(e[5]-e[7])*s,t[1]=(e[6]-e[2])*s,t[2]=(e[1]-e[3])*s;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var n=(r+1)%3,h=(r+2)%3;s=Math.sqrt(e[3*r+r]-e[3*n+n]-e[3*h+h]+1),t[r]=.5*s,s=.5/s,t[3]=(e[3*n+h]-e[3*h+n])*s,t[n]=(e[3*n+r]+e[3*r+n])*s,t[h]=(e[3*h+r]+e[3*r+h])*s}}(this,t),this.check()}identity(){return function(t){t[0]=0,t[1]=0,t[2]=0,t[3]=1}(this),this.check()}fromAxisRotation(t,e){return Mt(this,t,e),this.check()}setAxisAngle(t,e){return this.fromAxisRotation(t,e)}get ELEMENTS(){return 4}get x(){return this[0]}set x(t){this[0]=P(t)}get y(){return this[1]}set y(t){this[1]=P(t)}get z(){return this[2]}set z(t){this[2]=P(t)}get w(){return this[3]}set w(t){this[3]=P(t)}len(){return vt(this)}lengthSquared(){return St(this)}dot(t,e){if(void 0!==e)throw new Error("Quaternion.dot only takes one argument");return function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}(this,t)}rotationTo(t,e){return kt(this,t,e),this.check()}add(t,e){if(void 0!==e)throw new Error("Quaternion.add only takes one argument");return function(t,e,s){t[0]=e[0]+s[0],t[1]=e[1]+s[1],t[2]=e[2]+s[2],t[3]=e[3]+s[3]}(this,this,t),this.check()}calculateW(){return function(t,e){var s=e[0],i=e[1],r=e[2];t[0]=s,t[1]=i,t[2]=r,t[3]=Math.sqrt(Math.abs(1-s*s-i*i-r*r))}(this,this),this.check()}conjugate(){return function(t,e){t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3]}(this,this),this.check()}invert(){return function(t,e){var s=e[0],i=e[1],r=e[2],n=e[3],h=s*s+i*i+r*r+n*n,a=h?1/h:0;t[0]=-s*a,t[1]=-i*a,t[2]=-r*a,t[3]=n*a}(this,this),this.check()}lerp(t,e,s){return function(t,e,s,i){var r=e[0],n=e[1],h=e[2],a=e[3];t[0]=r+i*(s[0]-r),t[1]=n+i*(s[1]-n),t[2]=h+i*(s[2]-h),t[3]=a+i*(s[3]-a)}(this,t,e,s),this.check()}multiplyRight(t,e){return i(!e),wt(this,this,t),this.check()}multiplyLeft(t,e){return i(!e),wt(this,t,this),this.check()}normalize(){const t=this.len(),e=t>0?1/t:0;return this[0]=this[0]*e,this[1]=this[1]*e,this[2]=this[2]*e,this[3]=this[3]*e,0===t&&(this[3]=1),this.check()}rotateX(t){return function(t,e,s){s*=.5;var i=e[0],r=e[1],n=e[2],h=e[3],a=Math.sin(s),o=Math.cos(s);t[0]=i*o+h*a,t[1]=r*o+n*a,t[2]=n*o-r*a,t[3]=h*o-i*a}(this,this,t),this.check()}rotateY(t){return function(t,e,s){s*=.5;var i=e[0],r=e[1],n=e[2],h=e[3],a=Math.sin(s),o=Math.cos(s);t[0]=i*o-n*a,t[1]=r*o+h*a,t[2]=n*o+i*a,t[3]=h*o-r*a}(this,this,t),this.check()}rotateZ(t){return function(t,e,s){s*=.5;var i=e[0],r=e[1],n=e[2],h=e[3],a=Math.sin(s),o=Math.cos(s);t[0]=i*o+r*a,t[1]=r*o-i*a,t[2]=n*o+h*a,t[3]=h*o-n*a}(this,this,t),this.check()}scale(t){return function(t,e,s){t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t[3]=e[3]*s}(this,this,t),this.check()}slerp(t,e,s){switch(arguments.length){case 1:({start:t=Ot,target:e,ratio:s}=arguments[0]);break;case 2:[e,s]=arguments,t=this}return function(t,e,s,i){var r,n,h,a,o,c=e[0],u=e[1],l=e[2],f=e[3],d=s[0],p=s[1],g=s[2],y=s[3];(n=c*d+u*p+l*g+f*y)<0&&(n=-n,d=-d,p=-p,g=-g,y=-y),1-n>T?(r=Math.acos(n),h=Math.sin(r),a=Math.sin((1-i)*r)/h,o=Math.sin(i*r)/h):(a=1-i,o=i),t[0]=a*c+o*d,t[1]=a*u+o*p,t[2]=a*l+o*g,t[3]=a*f+o*y}(this,t,e,s),this.check()}transformVector4(t,e=t){return function(t,e,s){var i=e[0],r=e[1],n=e[2],h=s[0],a=s[1],o=s[2],c=s[3],u=c*i+a*n-o*r,l=c*r+o*i-h*n,f=c*n+h*r-a*i,d=-h*i-a*r-o*n;t[0]=u*c+d*-h+l*-o-f*-a,t[1]=l*c+d*-a+f*-h-u*-o,t[2]=f*c+d*-o+u*-a-l*-h,t[3]=e[3]}(e,t,this),A(e,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(t,e){return this.setAxisAngle(t,e)}premultiply(t,e){return this.multiplyLeft(t,e)}multiply(t,e){return this.multiplyRight(t,e)}}const Pt={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:2*Math.PI},At=1e-6;class Lt{constructor({phi:t=0,theta:e=0,radius:s=1,bearing:i,pitch:r,altitude:n,radiusScale:h=6371e3}={}){this.phi=t,this.theta=e,this.radius=s||n||1,this.radiusScale=h||1,void 0!==i&&(this.bearing=i),void 0!==r&&(this.pitch=r),this.check()}toString(){return this.formatString(h)}formatString({printTypes:t=!1}){const e=o;return"".concat(t?"Spherical":"","[rho:").concat(e(this.radius),",theta:").concat(e(this.theta),",phi:").concat(e(this.phi),"]")}equals(t){return S(this.radius,t.radius)&&S(this.theta,t.theta)&&S(this.phi,t.phi)}exactEquals(t){return this.radius===t.radius&&this.theta===t.theta&&this.phi===t.phi}get bearing(){return 180-g(this.phi)}set bearing(t){this.phi=Math.PI-p(t)}get pitch(){return g(this.theta)}set pitch(t){this.theta=p(t)}get longitude(){return g(this.phi)}get latitude(){return g(this.theta)}get lng(){return g(this.phi)}get lat(){return g(this.theta)}get z(){return(this.radius-1)*this.radiusScale}set(t,e,s){return this.radius=t,this.phi=e,this.theta=s,this.check()}clone(){return(new Lt).copy(this)}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this.check()}fromLngLatZ([t,e,s]){this.radius=1+s/this.radiusScale,this.phi=p(e),this.theta=p(t)}fromVector3(t){return this.radius=X(t),this.radius>0&&(this.theta=Math.atan2(t[0],t[1]),this.phi=Math.acos(b(t[2]/this.radius,-1,1))),this.check()}toVector3(){return new J(0,0,this.radius).rotateX({radians:this.theta}).rotateZ({radians:this.phi})}makeSafe(){return this.phi=Math.max(At,Math.min(Math.PI-At,this.phi)),this}check(){if(!(Number.isFinite(this.phi)&&Number.isFinite(this.theta)&&this.radius>0))throw new Error("SphericalCoordinates: some fields set to invalid numbers");return this}}const Rt="Unknown Euler angle order",Nt=.99999;class It extends _{static get ZYX(){return 0}static get YXZ(){return 1}static get XZY(){return 2}static get ZXY(){return 3}static get YZX(){return 4}static get XYZ(){return 5}static get RollPitchYaw(){return 0}static get DefaultOrder(){return It.ZYX}static get RotationOrders(){return["ZYX","YXZ","XZY","ZXY","YZX","XYZ"]}static rotationOrder(t){return It.RotationOrders[t]}get ELEMENTS(){return 4}constructor(t=0,e=0,s=0,i=It.DefaultOrder){super(-0,-0,-0,-0),arguments.length>0&&Array.isArray(arguments[0])?this.fromVector3(...arguments):this.set(t,e,s,i)}fromQuaternion(t){const[e,s,i,r]=t,n=s*s,h=-2*(n+i*i)+1,a=2*(e*s+r*i);let o=-2*(e*i-r*s);const c=2*(s*i+r*e),u=-2*(e*e+n)+1;o=o>1?1:o,o=o<-1?-1:o;const l=Math.atan2(c,u),f=Math.asin(o),d=Math.atan2(a,h);return new It(l,f,d,It.RollPitchYaw)}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=Number.isFinite(t[3])||this.order,this.check()}set(t=0,e=0,s=0,i){return this[0]=t,this[1]=e,this[2]=s,this[3]=Number.isFinite(i)?i:this[3],this.check()}validate(){return(t=this[3])>=0&&t<6&&Number.isFinite(this[0])&&Number.isFinite(this[1])&&Number.isFinite(this[2]);var t}toArray(t=[],e=0){return t[e]=this[0],t[e+1]=this[1],t[e+2]=this[2],t}toArray4(t=[],e=0){return t[e]=this[0],t[e+1]=this[1],t[e+2]=this[2],t[e+3]=this[3],t}toVector3(t=[-0,-0,-0]){return t[0]=this[0],t[1]=this[1],t[2]=this[2],t}get x(){return this[0]}set x(t){this[0]=P(t)}get y(){return this[1]}set y(t){this[1]=P(t)}get z(){return this[2]}set z(t){this[2]=P(t)}get alpha(){return this[0]}set alpha(t){this[0]=P(t)}get beta(){return this[1]}set beta(t){this[1]=P(t)}get gamma(){return this[2]}set gamma(t){this[2]=P(t)}get phi(){return this[0]}set phi(t){this[0]=P(t)}get theta(){return this[1]}set theta(t){this[1]=P(t)}get psi(){return this[2]}set psi(t){this[2]=P(t)}get roll(){return this[0]}set roll(t){this[0]=P(t)}get pitch(){return this[1]}set pitch(t){this[1]=P(t)}get yaw(){return this[2]}set yaw(t){this[2]=P(t)}get order(){return this[3]}set order(t){this[3]=function(t){if(t<0&&t>=6)throw new Error(Rt);return t}(t)}fromVector3(t,e){return this.set(t[0],t[1],t[2],Number.isFinite(e)?e:this[3])}fromArray(t,e=0){return this[0]=t[0+e],this[1]=t[1+e],this[2]=t[2+e],void 0!==t[3]&&(this[3]=t[3]),this.check()}fromRollPitchYaw(t,e,s){return this.set(t,e,s,It.ZYX)}fromRotationMatrix(t,e=It.DefaultOrder){return this._fromRotationMatrix(t,e),this.check()}getRotationMatrix(t){return this._getRotationMatrix(t)}getQuaternion(){const t=new _t;switch(this[3]){case It.XYZ:return t.rotateX(this[0]).rotateY(this[1]).rotateZ(this[2]);case It.YXZ:return t.rotateY(this[0]).rotateX(this[1]).rotateZ(this[2]);case It.ZXY:return t.rotateZ(this[0]).rotateX(this[1]).rotateY(this[2]);case It.ZYX:return t.rotateZ(this[0]).rotateY(this[1]).rotateX(this[2]);case It.YZX:return t.rotateY(this[0]).rotateZ(this[1]).rotateX(this[2]);case It.XZY:return t.rotateX(this[0]).rotateZ(this[1]).rotateY(this[2]);default:throw new Error(Rt)}}_fromRotationMatrix(t,e=It.DefaultOrder){const s=t.elements,i=s[0],r=s[4],n=s[8],h=s[1],a=s[5],o=s[9],c=s[2],u=s[6],l=s[10];switch(e=e||this[3]){case It.XYZ:this[1]=Math.asin(b(n,-1,1)),Math.abs(n)<Nt?(this[0]=Math.atan2(-o,l),this[2]=Math.atan2(-r,i)):(this[0]=Math.atan2(u,a),this[2]=0);break;case It.YXZ:this[0]=Math.asin(-b(o,-1,1)),Math.abs(o)<Nt?(this[1]=Math.atan2(n,l),this[2]=Math.atan2(h,a)):(this[1]=Math.atan2(-c,i),this[2]=0);break;case It.ZXY:this[0]=Math.asin(b(u,-1,1)),Math.abs(u)<Nt?(this[1]=Math.atan2(-c,l),this[2]=Math.atan2(-r,a)):(this[1]=0,this[2]=Math.atan2(h,i));break;case It.ZYX:this[1]=Math.asin(-b(c,-1,1)),Math.abs(c)<Nt?(this[0]=Math.atan2(u,l),this[2]=Math.atan2(h,i)):(this[0]=0,this[2]=Math.atan2(-r,a));break;case It.YZX:this[2]=Math.asin(b(h,-1,1)),Math.abs(h)<Nt?(this[0]=Math.atan2(-o,a),this[1]=Math.atan2(-c,i)):(this[0]=0,this[1]=Math.atan2(n,l));break;case It.XZY:this[2]=Math.asin(-b(r,-1,1)),Math.abs(r)<Nt?(this[0]=Math.atan2(u,a),this[1]=Math.atan2(n,i)):(this[0]=Math.atan2(-o,l),this[1]=0);break;default:throw new Error(Rt)}return this[3]=e,this}_getRotationMatrix(t){const e=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],s=this.x,i=this.y,r=this.z,n=Math.cos(s),h=Math.cos(i),a=Math.cos(r),o=Math.sin(s),c=Math.sin(i),u=Math.sin(r);switch(this[3]){case It.XYZ:{const t=n*a,s=n*u,i=o*a,r=o*u;e[0]=h*a,e[4]=-h*u,e[8]=c,e[1]=s+i*c,e[5]=t-r*c,e[9]=-o*h,e[2]=r-t*c,e[6]=i+s*c,e[10]=n*h;break}case It.YXZ:{const t=h*a,s=h*u,i=c*a,r=c*u;e[0]=t+r*o,e[4]=i*o-s,e[8]=n*c,e[1]=n*u,e[5]=n*a,e[9]=-o,e[2]=s*o-i,e[6]=r+t*o,e[10]=n*h;break}case It.ZXY:{const t=h*a,s=h*u,i=c*a,r=c*u;e[0]=t-r*o,e[4]=-n*u,e[8]=i+s*o,e[1]=s+i*o,e[5]=n*a,e[9]=r-t*o,e[2]=-n*c,e[6]=o,e[10]=n*h;break}case It.ZYX:{const t=n*a,s=n*u,i=o*a,r=o*u;e[0]=h*a,e[4]=i*c-s,e[8]=t*c+r,e[1]=h*u,e[5]=r*c+t,e[9]=s*c-i,e[2]=-c,e[6]=o*h,e[10]=n*h;break}case It.YZX:{const t=n*h,s=n*c,i=o*h,r=o*c;e[0]=h*a,e[4]=r-t*u,e[8]=i*u+s,e[1]=u,e[5]=n*a,e[9]=-o*a,e[2]=-c*a,e[6]=s*u+i,e[10]=t-r*u;break}case It.XZY:{const t=n*h,s=n*c,i=o*h,r=o*c;e[0]=h*a,e[4]=-u,e[8]=c*a,e[1]=t*u+r,e[5]=n*a,e[9]=s*u-i,e[2]=i*u-s,e[6]=o*a,e[10]=r*u+t;break}default:throw new Error(Rt)}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}toQuaternion(){const t=Math.cos(.5*this.yaw),e=Math.sin(.5*this.yaw),s=Math.cos(.5*this.roll),i=Math.sin(.5*this.roll),r=Math.cos(.5*this.pitch),n=Math.sin(.5*this.pitch);return new _t(t*i*r-e*s*n,t*s*n+e*i*r,e*s*r-t*i*n,t*s*r+e*i*n)}}class Tt{constructor({x:t=0,y:e=0,z:s=0,roll:i=0,pitch:r=0,yaw:n=0,position:h,orientation:a}={}){Array.isArray(h)&&3===h.length?this.position=new J(h):this.position=new J(t,e,s),Array.isArray(a)&&4===a.length?this.orientation=new It(a,a[3]):this.orientation=new It(i,r,n,It.RollPitchYaw)}get x(){return this.position.x}set x(t){this.position.x=t}get y(){return this.position.y}set y(t){this.position.y=t}get z(){return this.position.z}set z(t){this.position.z=t}get roll(){return this.orientation.roll}set roll(t){this.orientation.roll=t}get pitch(){return this.orientation.pitch}set pitch(t){this.orientation.pitch=t}get yaw(){return this.orientation.yaw}set yaw(t){this.orientation.yaw=t}getPosition(){return this.position}getOrientation(){return this.orientation}equals(t){return!!t&&this.position.equals(t.position)&&this.orientation.equals(t.orientation)}exactEquals(t){return!!t&&this.position.exactEquals(t.position)&&this.orientation.exactEquals(t.orientation)}getTransformationMatrix(){const t=Math.sin(this.roll),e=Math.sin(this.pitch),s=Math.sin(this.yaw),i=Math.cos(this.roll),r=Math.cos(this.pitch),n=Math.cos(this.yaw);return(new yt).setRowMajor(n*r,-s*i+n*e*t,s*t+n*e*i,this.x,s*r,n*i+s*e*t,-n*t+s*e*i,this.y,-e,r*t,r*i,this.z,0,0,0,1)}getTransformationMatrixFromPose(t){return(new yt).multiplyRight(this.getTransformationMatrix()).multiplyRight(t.getTransformationMatrix().invert())}getTransformationMatrixToPose(t){return(new yt).multiplyRight(t.getTransformationMatrix()).multiplyRight(this.getTransformationMatrix().invert())}}const Ct="undefined"!=typeof self&&self,Vt="undefined"!=typeof window&&window;(void 0!==s.g&&s.g||Ct||Vt).mathgl={config:h}},434:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=i(s(319));e.default=class{constructor(t){this.uri=t}async getImageData(t,e){return this.loadFile().then((async s=>{const i=await createImageBitmap(s),n=document.createElement("canvas"),h=n.getContext("2d");return n.width=e.width/r.default.OFFSET,n.height=e.height/r.default.OFFSET,h.drawImage(i,t>1?n.width*(t-1):0,0,n.width,n.height,0,0,n.width,n.height),h.getImageData(0,0,n.width,n.height).data}))}async loadFile(){const t=await fetch(this.uri),e=await t.blob();return new File([e],"bitmap.png",e)}}},862:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=i(s(974)),n=i(s(661)),h=i(s(291)),a=i(s(660));class o extends n.default{constructor(t,e){super(t,e),this.lastTime=(new Date).getTime(),this.unprocessedFrames=0,this.width=t,this.height=e,this.context=this.getInstance(),this.gameScreen=new h.default(this.context),this.run()}run(){r.default.disableImageSmoothing(this.context),this.gameScreen.init(),window.requestAnimationFrame((()=>this.tick()))}tick(){r.default.clearRect(this.context,this.width,this.height);const t=(new Date).getTime();for(this.unprocessedFrames+=60*(t-this.lastTime)*1e3,this.unprocessedFrames>10&&(this.unprocessedFrames=10);this.unprocessedFrames>1;)this.gameScreen.tick(),this.unprocessedFrames--;this.render(),this.gameScreen.playerDead?this.gameScreen.playerDead&&new a.default(this.context).render():window.requestAnimationFrame((()=>this.tick()))}render(){this.gameScreen.render()}}new o(800,512)},319:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(648),n=i(s(974)),h=i(s(777)),a=i(s(335)),o=i(s(126)),c=i(s(434)),u=i(s(134)),l=i(s(148)),f=i(s(111)),d=i(s(317));class p{constructor(t){this.renderables=new Array,this.collidables=new Array,this.pixels=new Array,this.bitmap=new c.default("../../assets/img/bitmap.png"),this.currentChunk=1,this.context=t}init(){this.loadPixels(),this.addBlocks()}refresh(){this.pixels=[],this.renderables=this.renderables.filter((t=>t instanceof f.default)),this.collidables=this.collidables.filter((t=>t instanceof f.default)),this.loadPixels(),this.addBlocks()}addBlocks(){this.loadPixels().then((()=>{this.pixels.forEach((t=>{switch(t.colorHex){case 4278190335:this.add(new h.default(t.pos,0));break;case 8388863:this.add(new h.default(t.pos,1));break;case 16711935:this.add(new o.default(t.pos));break;case 65535:this.add(new a.default(t.pos));break;case 2739512575:this.add(new l.default(t.pos));break;case 3284386815:this.add(new d.default(this,new r.Vector2(16,0),new r.Vector2(32,32).clone().divideScalar(2),t.pos,new r.Vector2(32,32),0));break;case 3301229823:this.add(new d.default(this,new r.Vector2(48,0),new r.Vector2(32,32).divideScalar(2),t.pos,new r.Vector2(32,32),1))}}))}))}add(t){return this.renderables.push(t),"isCollidable"in t?(this.collidables.push(t),t):t}remove(t){this.renderables=this.renderables.filter((e=>t.pos!==e.pos))}getAllRenderables(){return this.renderables}getAllCollidables(){return this.collidables}render(){n.default.disableImageSmoothing(this.context),this.getAllRenderables().forEach((t=>t.render(this.context)))}async loadPixels(){return this.bitmap.getImageData(this.currentChunk,this.context.canvas).then((t=>{const e=new r.Vector2(0,0);for(let s=4;s<=t.length;s+=4){const i=Array.from(t.subarray(s-4,s));e.x>=25&&(e.x=0,e.y++),this.pixels.push(new u.default(new r.Vector2(e.x,e.y),new r.Vector4(i))),e.x++}this.pixels=this.pixels.filter(((t,e,s)=>e===s.findIndex((e=>e.pos.equals(t.pos.elements)))))}))}}e.default=p,p.OFFSET=32},134:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=i(s(6)),n=i(s(291));e.default=class{constructor(t,e){this.pos=t.multiplyByScalar(n.default.SCALE),this.color=e,this.colorHex=r.default.rgba2Hex(e)}}},443:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t){this.width=0,this.height=0,this.loaded=!0,this.url=t}load(){const t=new Image;return t.onload=e=>{this.width=t.width,this.height=t.height,this.loaded=!0},t.src=this.url?this.url:"",t}}},478:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(648),n=i(s(974)),h=i(s(443));e.default=class{constructor(t){this.size=new r.Vector2(32,32),this.spriteSheet=new h.default("../assets/img/blocks.png"),this.sSize=this.size.clone().divideScalar(2),this.pos=t,this.isCollidable=!0,this.img=this.spriteSheet.load()}render(t){n.default.drawImage(t,this.img,this.sPos,this.sSize.clone().sub(new r.Vector2(1,0)),this.pos,this.size)}}},777:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(648),n=i(s(478));class h extends n.default{constructor(t,e){super(t),this.sPos=new r.Vector2(0,0),1===e&&(this.sPos=new r.Vector2(48,0))}}e.default=h},148:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(648),n=i(s(478));class h extends n.default{constructor(t){super(t),this.sPos=new r.Vector2(0,16)}}e.default=h},126:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(648),n=i(s(478));class h extends n.default{constructor(t){super(t),this.sPos=new r.Vector2(32,0)}}e.default=h},335:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(648),n=i(s(478));class h extends n.default{constructor(t){super(t),this.sPos=new r.Vector2(16,0)}}e.default=h},661:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t,e){this.width=t,this.height=e}getInstance(){const t=document.querySelector("#game");t.width=this.width,t.height=this.height;const e=t.getContext("2d");if(null===e)throw"Your browser don't support canvas :(";return e}}},740:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});const i=s(402);e.default=class{static getPseduoKeyCode(t){let e=null;switch(t){case"KeyW":e=i.Keys.W;break;case"KeyA":e=i.Keys.A;break;case"KeyS":e=i.Keys.S;break;case"KeyD":e=i.Keys.D;break;case"KeyE":e=i.Keys.E}return e}}},354:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(648),n=i(s(686)),h=i(s(987)),a=i(s(111));class o extends h.default{constructor(t,e,s,i,n,h){super(t,new r.Vector2(0,0),new r.Vector2(16,16),e,s),this.level=t,this.speed=4*i,this.direction=n,this.source=h}render(){if((!super.isInChunk()||super.intersects()&&this.source instanceof a.default)&&this.level.remove(this),!(this.source instanceof a.default))for(const t of this.level.getAllRenderables())t instanceof a.default&&n.default.intersects(this,t)&&(t.alive=!1);switch(this.direction){case 0:this.pos.x-=this.speed;break;case 1:this.pos.x+=this.speed;break;case 2:this.pos.x-=this.speed,this.pos.y-=this.speed;break;case 3:this.pos.x+=this.speed,this.pos.y-=this.speed;break;case 4:this.pos.x+=this.speed,this.pos.y+=this.speed;break;case 5:this.pos.x-=this.speed,this.pos.y+=this.speed}super.render(this.level.context)}}e.default=o},851:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=i(s(987));class n extends r.default{constructor(t,e,s,i,r){super(t,e,s,i,r)}updateDirection(){"l"===super.getCollisionFace()?this.direction=0:"r"===super.getCollisionFace()&&(this.direction=1)}}e.default=n},987:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(648),n=i(s(974)),h=i(s(686)),a=i(s(319)),o=i(s(443));e.default=class{constructor(t,e,s,i,r){this.spriteSheet=new o.default("../assets/img/entities.png"),this.direction=0,this.sPos=e,this.sSize=s,this.pos=i,this.size=r,this.img=this.spriteSheet.load(),this.level=t}render(t){n.default.drawImage(t,this.img,this.sPos,this.sSize.clone().sub(new r.Vector2(1,0)),this.pos,this.size)}isColliding(){for(const t of this.level.getAllCollidables())if(null!==h.default.checkCollision(this,t))return!0;return!1}getCollisionFace(){for(const t of this.level.getAllCollidables()){const e=h.default.checkCollision(this,t);if(null!==e)return e}return null}intersects(){for(const t of this.level.getAllCollidables())if(h.default.intersects(this,t))return!0;return!1}isInChunk(){const t=this.level.context.canvas,e=a.default.OFFSET/2,s=new r.Vector2(e,e),i=new r.Vector2(t.width-e,t.height-e);return this.pos.x>s.x&&this.pos.x<i.x&&this.pos.y>s.y&&this.pos.y<i.y}}},111:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(648),n=i(s(974)),h=s(402),a=i(s(740)),o=i(s(686)),c=i(s(319)),u=i(s(443)),l=i(s(354)),f=i(s(987)),d=i(s(148)),p=i(s(291));class g extends f.default{constructor(t,e,s,i,n){super(t,e,s,i,n),this.spriteSheet=new u.default("../assets/img/player.png"),this.direction=null,this.jumping=!1,this.falling=!1,this.grounded=!0,this.shooting=!1,this.alive=!0,this.movingLeft=!1,this.movingRight=!1,this.speed=.6,this.speedA=.6,this.keysDown=new Array,this.posA=new r.Vector2,this.level=t,this.img=this.spriteSheet.load(),window.onkeydown=t=>this.onKeyDown(t),window.onkeyup=t=>this.onKeyUp(t)}render(t){let e=0;this.jumping||this.falling?e=1*p.default.SCALE:this.movingRight?e=2*p.default.SCALE:this.movingLeft?e=3*p.default.SCALE:0===this.direction?e=5*p.default.SCALE:1===this.direction&&(e=4*p.default.SCALE),this.sPos=new r.Vector2(e,0),this.alive||(e=6*p.default.SCALE,this.size=new r.Vector2(48,p.default.SCALE-8),this.sPos=new r.Vector2(e,0===this.direction?24:0),this.sSize=this.size),this.sSize=this.size,n.default.drawImage(t,this.img,this.sPos,this.sSize,this.pos,this.size)}tick(){this.keyboardMove();const t=this.level.context.canvas,e=c.default.OFFSET/2,s=new r.Vector2(e,e),i=new r.Vector2(t.width-e,t.height-e);this.pos.x<s.x&&(this.pos.x=s.x),this.pos.x>i.x&&this.goToNextChunk(),this.pos.y<s.y&&(this.pos.y=s.y),this.pos.y>i.y&&(this.pos.y=i.y);for(const t of this.level.getAllCollidables()){const e=o.default.checkCollision(this,t);if(null!==e)switch(t instanceof d.default&&(this.alive=!1),e){case"b":this.jumping&&(this.falling=!0,this.jumping=!1);break;case"t":this.falling&&(this.grounded=!0,this.falling=!1)}}this.grounded&&!this.intersects()&&(this.grounded=!1,this.falling=!0),this.falling&&!this.grounded&&(this.pos.y+=this.speed),this.speed=this.speedA,this.tryJump()}keyboardMove(){this.keysDown[h.Keys.W]&&this.grounded&&(this.posA=new r.Vector2(this.pos.x,this.pos.y),this.jumping=!0),this.keysDown[h.Keys.A]&&(this.pos.x-=this.speed,this.movingLeft=!0,this.movingRight=!1,this.direction=0),this.keysDown[h.Keys.D]&&(this.pos.x+=this.speed,this.movingLeft=!1,this.movingRight=!0,this.direction=1),this.keysDown[h.Keys.E]&&!this.shooting&&this.tryShoot(),this.keysDown.find((t=>!0===t))||(this.shooting=!1,this.movingLeft=!1,this.movingRight=!1)}tryJump(){this.jumping&&(this.grounded=!1,this.falling=!1,this.pos.y-=this.speed,this.pos.y<this.posA.y-96&&(this.jumping=!1,this.falling=!0))}tryShoot(){this.shooting=!0;const t=new r.Vector2(16,16);this.level.add(new l.default(this.level,this.pos.clone(),t,this.speed,this.direction,this))}goToNextChunk(){this.pos.x=c.default.OFFSET,this.level.currentChunk++,this.level.refresh()}onKeyDown(t){const e=a.default.getPseduoKeyCode(t.code);null!==e&&(this.keysDown[e]=!0)}onKeyUp(t){const e=a.default.getPseduoKeyCode(t.code);null!==e&&(this.keysDown[e]=!1)}}e.default=g},317:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(648),n=i(s(6)),h=i(s(319)),a=i(s(354)),o=i(s(851));class c extends o.default{constructor(t,e,s,i,r,n){super(t,e,s,i,r),this.shooting=!1,this.direction=n,this.sPosA=this.sPos.clone()}render(t){this.tick();const e=h.default.OFFSET/2;this.sPos=this.sPosA.clone(),this.shooting&&0===this.direction?this.sPos.x=2*e:this.shooting&&1===this.direction&&(this.sPos.x=4*e),super.render(t)}tick(){!this.shooting&&n.default.randomRange(0,1e3)<5?this.tryShoot():this.shooting&&n.default.randomRange(0,100)<3&&(this.shooting=!1)}tryShoot(){this.shooting=!0,this.level.add(new a.default(this.level,this.pos.clone().sub(new r.Vector2(0,8)),this.size.clone().divideScalar(2),.6,0===this.direction?3:2,this)),this.level.add(new a.default(this.level,this.pos.clone().add(new r.Vector2(0,16)),this.size.clone().divideScalar(2),.6,0===this.direction?4:5,this))}}e.default=c},402:(t,e)=>{var s;Object.defineProperty(e,"__esModule",{value:!0}),e.Keys=void 0,(s=e.Keys||(e.Keys={}))[s.W=0]="W",s[s.A=1]="A",s[s.S=2]="S",s[s.D=3]="D",s[s.E=4]="E"},974:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});class s extends CanvasRenderingContext2D{static renderRect(t,e,s,i,r=!1){this.resetFillStyle(t),t.fillStyle=this.getColor(i).toString(),t.fillRect(e.x,e.y,s.x,s.y),r&&t.strokeRect(e.x,e.y,s.x,s.y),this.resetFillStyle(t)}static renderCircle(t,e,s,i,r=!1,n=!0){this.resetFillStyle(t),t.beginPath(),t.fillStyle=this.getColor(i).toString(),t.arc(e.x,e.y,s.x+s.y??0,0,2*Math.PI),n&&t.fill(),r&&t.stroke(),this.resetFillStyle(t)}static renderText(t,e,s,i,r,n){t.font=s,t.fillStyle=this.getColor(n),t.fillText(e,i.x,i.y,r),this.resetTextSettings(t)}static renderShadows(t,e,s,i){t.shadowColor=e,t.shadowBlur=s,t.shadowOffsetX=i.x,t.shadowOffsetY=i.y}static drawImage(t,e,s,i,r,n){t.drawImage(e,s.x,s.y,i.x,i.y,r.x,r.y,n.x,n.y)}static disableImageSmoothing(t){t.imageSmoothingEnabled=!1}static clearRect(t,e,s){t.clearRect(0,0,e,s)}static resetImageSmoothing(t){t.imageSmoothingEnabled=!0}static resetShadows(t){t.shadowColor="rgba(0, 0, 0, 0.0)",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0}static resetFillStyle(t){t.fillStyle="rgb(0, 0, 0)"}static resetTextSettings(t){t.font="10px sans-serif",s.resetFillStyle(t)}static getColor(t){return`rgba(${t.x}, ${t.y}, ${t.z}, ${t.w})`}}e.default=s},6:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});class s{static range(t,e){const s=[];for(let i=t;i<=e;i++)s.push(i);return s}static isInRange(t,e){return t>=e[0]&&t<=e[1]}static randomRange(t,e){return Math.floor(Math.random()*(e-t+1)+t)}static newGuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))}static rgba2Hex(t){let e="";for(const i of t.elements)e+=s.rgbaValue2Hex(i);return parseInt("0x"+e)}static rgbaValue2Hex(t){let e=Number(t).toString(16);return e.length<2&&(e="0"+e),e}}e.default=s},686:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(648),n=i(s(111));e.default=class{static checkCollision(t,e){const s=t.pos.x+t.size.x/2-(e.pos.x+e.size.x/2),i=t.pos.y+t.size.y/2-(e.pos.y+e.size.y/2),h=new r.Vector2(s,i),a=new r.Vector2(t.size.x/2+e.size.x/2,t.size.y/2+e.size.y/2);let o=null;if(Math.abs(h.x)<a.x&&Math.abs(h.y)<a.y){const e=a.x-Math.abs(h.x),s=a.y-Math.abs(h.y);if(e>=s)return t instanceof n.default&&t.falling&&(t.grounded=!0,t.falling=!1),o=h.y>0?"b":"t",h.y>0?t.pos.y+=s:t.pos.y-=s,o;o=h.x>0?"r":"l",h.x>0?t.pos.x+=e:t.pos.x-=e}return o}static intersects(t,e){return t.pos.x<e.pos.x+e.size.x&&t.pos.x+t.size.x>e.pos.x&&(t instanceof n.default?t.pos.y+.25:t.pos.y)<e.pos.y+e.size.y&&(t instanceof n.default?t.pos.y+.25:t.pos.y)+t.size.y>e.pos.y}}},660:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(648),n=i(s(974)),h=i(s(821));class a extends h.default{constructor(t){super(t)}render(){const t=this.context.canvas;this.renderOverlay(t);const e=new r.Vector2(200,100),s=new r.Vector2((t.width-e.x)/2,(t.height-e.y)/2);let i=new r.Vector4(255,0,0,1);n.default.renderRect(this.context,s,e,i),i=new r.Vector4(0,255,255,1),s.add(e.clone().divideScalar(2)),s.x-=48,s.y+=6,n.default.renderText(this.context,"Game over!","24px Consolas",s,e.y,i)}renderOverlay(t){n.default.renderRect(this.context,new r.Vector2(0,0),new r.Vector2(t.width,t.height),new r.Vector4(0,0,0,.5))}}e.default=a},291:function(t,e,s){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=s(648),n=i(s(111)),h=i(s(319)),a=i(s(821));class o extends a.default{constructor(t){super(t),this.playerDead=!1,this.player=null,this.level=new h.default(t)}init(){this.level.init(),this.player=this.summonPlayer(),this.level.add(this.player)}tick(){const t=this.player;t.alive?t.tick():(t.pos.y+=10,this.playerDead=!0)}render(){this.level.render()}summonPlayer(){const t=new r.Vector2,e=new r.Vector2,s=new r.Vector2(384,128),i=new r.Vector2(o.SCALE,o.SCALE+o.SCALE/2);return new n.default(this.level,t,e,s,i)}}e.default=o,o.SCALE=32},821:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t){this.context=t}}}},e={};function s(i){var r=e[i];if(void 0!==r)return r.exports;var n=e[i]={exports:{}};return t[i].call(n.exports,n,n.exports,s),n.exports}s.d=(t,e)=>{for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),s.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s(862)})();